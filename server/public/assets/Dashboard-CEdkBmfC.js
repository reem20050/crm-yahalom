import{c as _e,R as u,d as ue,r as pe,e as Ae,f as X,j as e,P as B,C as H,A as Q,F as ee,L as E,U as ke,B as Pe,g as Ce,h as Y}from"./index-CqrGJYtT.js";import{S as F}from"./shield-B8_YxS0l.js";import{f as R,L as q,m as G,i as M,C as J,A as Oe,a as I,b as ie,c as Ee,d as le,h as Se,e as Le,u as De,g as se,G as $e,j as ce,k as oe,D as Re,l as Ie,X as ge,Y as ye,n as Me,T as re,R as fe,o as Be,p as Te,q as Ke,r as We}from"./LineChart-C84NITl_.js";import{P as Z}from"./package-BclyIs99.js";import{C as T}from"./check-circle-BYK8BHV6.js";import{M as de}from"./map-pin-CiqgE478.js";import{A as je}from"./alert-circle-BHR8TW13.js";import{P as Ve}from"./phone-Be-FhdAg.js";import{A as me}from"./arrow-left-right-DkbP8gFT.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=_e("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var Fe=["layout","type","stroke","connectNulls","isRange","ref"],ze=["key"],be;function K(s){"@babel/helpers - typeof";return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(s)}function ve(s,t){if(s==null)return{};var n=Xe(s,t),r,c;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(c=0;c<l.length;c++)r=l[c],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(s,r)&&(n[r]=s[r])}return n}function Xe(s,t){if(s==null)return{};var n={};for(var r in s)if(Object.prototype.hasOwnProperty.call(s,r)){if(t.indexOf(r)>=0)continue;n[r]=s[r]}return n}function D(){return D=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])}return s},D.apply(this,arguments)}function xe(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),n.push.apply(n,r)}return n}function O(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xe(Object(n),!0).forEach(function(r){A(s,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(n,r))})}return s}function Ye(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function he(s,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,we(r.key),r)}}function Ge(s,t,n){return t&&he(s.prototype,t),n&&he(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}function He(s,t,n){return t=U(t),Ue(s,Ne()?Reflect.construct(t,n||[],U(s).constructor):t.apply(s,n))}function Ue(s,t){if(t&&(K(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qe(s)}function Qe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ne(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ne=function(){return!!s})()}function U(s){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},U(s)}function Je(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&te(s,t)}function te(s,t){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},te(s,t)}function A(s,t,n){return t=we(t),t in s?Object.defineProperty(s,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[t]=n,s}function we(s){var t=Ze(s,"string");return K(t)=="symbol"?t:t+""}function Ze(s,t){if(K(s)!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var r=n.call(s,t);if(K(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var S=function(s){function t(){var n;Ye(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return n=He(this,t,[].concat(c)),A(n,"state",{isAnimationFinished:!0}),A(n,"id",De("recharts-area-")),A(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),se(o)&&o()}),A(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),se(o)&&o()}),n}return Je(t,s),Ge(t,[{key:"renderDots",value:function(r,c,l){var o=this.props.isAnimationActive,d=this.state.isAnimationFinished;if(o&&!d)return null;var x=this.props,m=x.dot,h=x.points,i=x.dataKey,a=R(this.props,!1),g=R(m,!0),f=h.map(function(j,_){var b=O(O(O({key:"dot-".concat(_),r:3},a),g),{},{index:_,cx:j.x,cy:j.y,dataKey:i,value:j.value,payload:j.payload,points:h});return t.renderDotItem(m,b)}),N={clipPath:r?"url(#clipPath-".concat(c?"":"dots-").concat(l,")"):null};return u.createElement(q,D({className:"recharts-area-dots"},N),f)}},{key:"renderHorizontalRect",value:function(r){var c=this.props,l=c.baseLine,o=c.points,d=c.strokeWidth,x=o[0].x,m=o[o.length-1].x,h=r*Math.abs(x-m),i=G(o.map(function(a){return a.y||0}));return M(l)&&typeof l=="number"?i=Math.max(l,i):l&&Array.isArray(l)&&l.length&&(i=Math.max(G(l.map(function(a){return a.y||0})),i)),M(i)?u.createElement("rect",{x:x<m?x:x-h,y:0,width:h,height:Math.floor(i+(d?parseInt("".concat(d),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var c=this.props,l=c.baseLine,o=c.points,d=c.strokeWidth,x=o[0].y,m=o[o.length-1].y,h=r*Math.abs(x-m),i=G(o.map(function(a){return a.x||0}));return M(l)&&typeof l=="number"?i=Math.max(l,i):l&&Array.isArray(l)&&l.length&&(i=Math.max(G(l.map(function(a){return a.x||0})),i)),M(i)?u.createElement("rect",{x:0,y:x<m?x:x-h,width:i+(d?parseInt("".concat(d),10):1),height:Math.floor(h)}):null}},{key:"renderClipRect",value:function(r){var c=this.props.layout;return c==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,c,l,o){var d=this.props,x=d.layout,m=d.type,h=d.stroke,i=d.connectNulls,a=d.isRange;d.ref;var g=ve(d,Fe);return u.createElement(q,{clipPath:l?"url(#clipPath-".concat(o,")"):null},u.createElement(J,D({},R(g,!0),{points:r,connectNulls:i,type:m,baseLine:c,layout:x,stroke:"none",className:"recharts-area-area"})),h!=="none"&&u.createElement(J,D({},R(this.props,!1),{className:"recharts-area-curve",layout:x,type:m,connectNulls:i,fill:"none",points:r})),h!=="none"&&a&&u.createElement(J,D({},R(this.props,!1),{className:"recharts-area-curve",layout:x,type:m,connectNulls:i,fill:"none",points:c})))}},{key:"renderAreaWithAnimation",value:function(r,c){var l=this,o=this.props,d=o.points,x=o.baseLine,m=o.isAnimationActive,h=o.animationBegin,i=o.animationDuration,a=o.animationEasing,g=o.animationId,f=this.state,N=f.prevPoints,j=f.prevBaseLine;return u.createElement(Oe,{begin:h,duration:i,isActive:m,easing:a,from:{t:0},to:{t:1},key:"area-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var b=_.t;if(N){var P=N.length/d.length,p=d.map(function(w,$){var L=Math.floor($*P);if(N[L]){var C=N[L],W=I(C.x,w.x),V=I(C.y,w.y);return O(O({},w),{},{x:W(b),y:V(b)})}return w}),y;if(M(x)&&typeof x=="number"){var v=I(j,x);y=v(b)}else if(ie(x)||Ee(x)){var k=I(j,0);y=k(b)}else y=x.map(function(w,$){var L=Math.floor($*P);if(j[L]){var C=j[L],W=I(C.x,w.x),V=I(C.y,w.y);return O(O({},w),{},{x:W(b),y:V(b)})}return w});return l.renderAreaStatically(p,y,r,c)}return u.createElement(q,null,u.createElement("defs",null,u.createElement("clipPath",{id:"animationClipPath-".concat(c)},l.renderClipRect(b))),u.createElement(q,{clipPath:"url(#animationClipPath-".concat(c,")")},l.renderAreaStatically(d,x,r,c)))})}},{key:"renderArea",value:function(r,c){var l=this.props,o=l.points,d=l.baseLine,x=l.isAnimationActive,m=this.state,h=m.prevPoints,i=m.prevBaseLine,a=m.totalLength;return x&&o&&o.length&&(!h&&a>0||!le(h,o)||!le(i,d))?this.renderAreaWithAnimation(r,c):this.renderAreaStatically(o,d,r,c)}},{key:"render",value:function(){var r,c=this.props,l=c.hide,o=c.dot,d=c.points,x=c.className,m=c.top,h=c.left,i=c.xAxis,a=c.yAxis,g=c.width,f=c.height,N=c.isAnimationActive,j=c.id;if(l||!d||!d.length)return null;var _=this.state.isAnimationFinished,b=d.length===1,P=ue("recharts-area",x),p=i&&i.allowDataOverflow,y=a&&a.allowDataOverflow,v=p||y,k=ie(j)?this.id:j,w=(r=R(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},$=w.r,L=$===void 0?3:$,C=w.strokeWidth,W=C===void 0?2:C,V=Se(o)?o:{},ae=V.clipDot,ne=ae===void 0?!0:ae,z=L*2+W;return u.createElement(q,{className:P},p||y?u.createElement("defs",null,u.createElement("clipPath",{id:"clipPath-".concat(k)},u.createElement("rect",{x:p?h:h-g/2,y:y?m:m-f/2,width:p?g:g*2,height:y?f:f*2})),!ne&&u.createElement("clipPath",{id:"clipPath-dots-".concat(k)},u.createElement("rect",{x:h-z/2,y:m-z/2,width:g+z,height:f+z}))):null,b?null:this.renderArea(v,k),(o||b)&&this.renderDots(v,ne,k),(!N||_)&&Le.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(r,c){return r.animationId!==c.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:c.curPoints,prevBaseLine:c.curBaseLine}:r.points!==c.curPoints||r.baseLine!==c.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(pe.PureComponent);be=S;A(S,"displayName","Area");A(S,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!$e.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});A(S,"getBaseValue",function(s,t,n,r){var c=s.layout,l=s.baseValue,o=t.props.baseValue,d=o??l;if(M(d)&&typeof d=="number")return d;var x=c==="horizontal"?r:n,m=x.scale.domain();if(x.type==="number"){var h=Math.max(m[0],m[1]),i=Math.min(m[0],m[1]);return d==="dataMin"?i:d==="dataMax"||h<0?h:Math.max(Math.min(m[0],m[1]),0)}return d==="dataMin"?m[0]:d==="dataMax"?m[1]:m[0]});A(S,"getComposedData",function(s){var t=s.props,n=s.item,r=s.xAxis,c=s.yAxis,l=s.xAxisTicks,o=s.yAxisTicks,d=s.bandSize,x=s.dataKey,m=s.stackedData,h=s.dataStartIndex,i=s.displayedData,a=s.offset,g=t.layout,f=m&&m.length,N=be.getBaseValue(t,n,r,c),j=g==="horizontal",_=!1,b=i.map(function(p,y){var v;f?v=m[h+y]:(v=ce(p,x),Array.isArray(v)?_=!0:v=[N,v]);var k=v[1]==null||f&&ce(p,x)==null;return j?{x:oe({axis:r,ticks:l,bandSize:d,entry:p,index:y}),y:k?null:c.scale(v[1]),value:v,payload:p}:{x:k?null:r.scale(v[1]),y:oe({axis:c,ticks:o,bandSize:d,entry:p,index:y}),value:v,payload:p}}),P;return f||_?P=b.map(function(p){var y=Array.isArray(p.value)?p.value[0]:null;return j?{x:p.x,y:y!=null&&p.y!=null?c.scale(y):null}:{x:y!=null?r.scale(y):null,y:p.y}}):P=j?c.scale(N):r.scale(N),O({points:b,baseLine:P,layout:g,isRange:_},a)});A(S,"renderDotItem",function(s,t){var n;if(u.isValidElement(s))n=u.cloneElement(s,t);else if(se(s))n=s(t);else{var r=ue("recharts-area-dot",typeof s!="boolean"?s.className:""),c=t.key,l=ve(t,ze);n=u.createElement(Re,D({},l,{key:c,className:r}))}return n});var es=Ie({chartName:"AreaChart",GraphicalChild:S,axisComponents:[{axisType:"xAxis",AxisComp:ge},{axisType:"yAxis",AxisComp:ye}],formatAxisMap:Me});function ps(){const[s,t]=pe.useState("operations"),{isEmployee:n}=Ae(),{data:r,isLoading:c}=X({queryKey:["dashboard-employee"],queryFn:()=>Y.get().then(i=>i.data),enabled:n,refetchInterval:6e4}),{data:l,isLoading:o}=X({queryKey:["dashboard"],queryFn:()=>Y.get().then(i=>i.data),enabled:!n&&s==="business"}),{data:d,isLoading:x}=X({queryKey:["dashboard-operations"],queryFn:()=>Y.getOperations().then(i=>i.data),enabled:!n&&s==="operations",refetchInterval:6e4}),{data:m}=X({queryKey:["dashboard-trends"],queryFn:()=>Y.getTrends().then(i=>i.data),enabled:!n&&s==="business"});return(n?c:s==="business"?o:x)?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):n?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"דשבורד"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"ברוך הבא למערכת צוות יהלום"})]}),e.jsx(ss,{data:r})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"דשבורד"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"ברוך הבא למערכת צוות יהלום"})]}),e.jsxs("div",{className:"flex bg-gray-100/80 rounded-xl p-1 gap-0.5",children:[e.jsxs("button",{onClick:()=>t("operations"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${s==="operations"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(F,{className:"w-4 h-4"}),"תפעולי"]}),e.jsxs("button",{onClick:()=>t("business"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${s==="business"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(re,{className:"w-4 h-4"}),"עסקי"]})]})]}),s==="operations"?e.jsx(ts,{data:d}):e.jsx(ns,{data:l,trends:m})]})}function ss({data:s}){const t=(s==null?void 0:s.myShiftsToday)||[],n=(s==null?void 0:s.myUpcomingEvents)||[],r=(s==null?void 0:s.myRecentShifts)||[],c=(s==null?void 0:s.myEquipment)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6",children:[e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-value",children:t.length}),e.jsx("p",{className:"stat-card-label",children:"משמרות היום"})]}),e.jsx("div",{className:"w-11 h-11 rounded-xl bg-sky-50 flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-sky-600"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-value",children:n.length}),e.jsx("p",{className:"stat-card-label",children:"אירועים ב-7 ימים"})]}),e.jsx("div",{className:"w-11 h-11 rounded-xl bg-amber-50 flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-amber-600"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-value",children:c.length}),e.jsx("p",{className:"stat-card-label",children:"פריטי ציוד"})]}),e.jsx("div",{className:"w-11 h-11 rounded-xl bg-violet-50 flex items-center justify-center",children:e.jsx(Z,{className:"w-5 h-5 text-violet-600"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-value",children:r.length}),e.jsx("p",{className:"stat-card-label",children:"משמרות אחרונות"})]}),e.jsx("div",{className:"w-11 h-11 rounded-xl bg-emerald-50 flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-emerald-600"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-sky-50 flex items-center justify-center",children:e.jsx(F,{className:"w-4 h-4 text-sky-600"})}),"המשמרות שלי היום"]}),t.length>0?e.jsx("div",{className:"space-y-2.5",children:t.map(l=>e.jsx("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:l.site_name||l.company_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[l.start_time," - ",l.end_time]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.check_in_time?e.jsxs("span",{className:"badge badge-success flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),"צ'ק-אין ",l.check_in_time]}):e.jsx("span",{className:"badge badge-warning",children:"ממתין לצ'ק-אין"}),l.check_out_time&&e.jsxs("span",{className:"badge badge-gray",children:["צ'ק-אאוט ",l.check_out_time]})]})]})},l.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx(F,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"אין משמרות היום"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center",children:e.jsx(B,{className:"w-4 h-4 text-amber-600"})}),"אירועים קרובים שלי"]}),n.length>0?e.jsx("div",{className:"space-y-2.5",children:n.map(l=>e.jsxs("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:l.event_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[l.event_date," | ",l.start_time," | ",l.location||l.company_name]}),l.role&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1.5 font-medium",children:["תפקיד: ",l.role]})]},l.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx(B,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"אין אירועים קרובים"})]})]}),c.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-50 flex items-center justify-center",children:e.jsx(Z,{className:"w-4 h-4 text-violet-600"})}),"הציוד שלי"]}),e.jsx("div",{className:"space-y-1.5",children:c.map((l,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-gray-50/60 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-sm text-gray-900",children:l.item_name}),e.jsx("span",{className:"text-xs text-gray-500",children:l.item_type})]}),l.serial_number&&e.jsx("span",{className:"text-xs text-gray-400 font-mono",dir:"ltr",children:l.serial_number})]},o))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center",children:e.jsx(H,{className:"w-4 h-4 text-emerald-600"})}),"היסטוריית משמרות אחרונות"]}),r.length>0?e.jsx("div",{className:"space-y-1.5",children:r.map((l,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-gray-50/60 rounded-lg text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:l.site_name||l.company_name}),e.jsx("span",{className:"text-gray-300 mx-2",children:"·"}),e.jsx("span",{className:"text-gray-500",children:l.date})]}),e.jsxs("span",{className:"text-gray-500 font-mono text-xs",children:[l.start_time," - ",l.end_time]})]},o))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx(H,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"אין היסטוריה"})]})]})]})]})}function ts({data:s}){var n,r,c,l,o,d,x,m,h,i;const t=[{name:"מאבטחים בשטח",value:`${(s==null?void 0:s.guards_on_duty)||0}/${(s==null?void 0:s.guards_expected_today)||0}`,icon:F,iconColor:"text-sky-600",bgColor:"bg-sky-50"},{name:"אתרים מכוסים",value:(s==null?void 0:s.sites_with_coverage)||0,icon:de,iconColor:"text-emerald-600",bgColor:"bg-emerald-50"},{name:"אירועי אבטחה פתוחים",value:((n=s==null?void 0:s.open_incidents)==null?void 0:n.count)||0,icon:Q,iconColor:((r=s==null?void 0:s.open_incidents)==null?void 0:r.critical)>0?"text-red-600":"text-red-500",bgColor:((c=s==null?void 0:s.open_incidents)==null?void 0:c.critical)>0?"bg-red-100":"bg-red-50",href:"/incidents"},{name:"רישיונות שפגים",value:((l=s==null?void 0:s.expiring_licenses)==null?void 0:l.length)||0,icon:ee,iconColor:"text-amber-600",bgColor:"bg-amber-50"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6",children:t.map(a=>{const g=a.href?E:"div",f=a.href?{to:a.href}:{};return e.jsx(g,{...f,className:"stat-card hover:shadow-elevated transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stat-card-value",children:a.value}),e.jsx("p",{className:"stat-card-label",children:a.name})]}),e.jsx("div",{className:`w-11 h-11 rounded-xl ${a.bgColor} flex items-center justify-center`,children:e.jsx(a.icon,{className:`w-5 h-5 ${a.iconColor}`})})]})},a.name)})}),((o=s==null?void 0:s.open_incidents)==null?void 0:o.critical)>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3 animate-fade-in",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Q,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-red-800 text-sm",children:[s.open_incidents.critical," אירועי אבטחה קריטיים פתוחים!"]}),e.jsx(E,{to:"/incidents?severity=critical",className:"text-red-600 hover:text-red-700 text-sm font-medium hover:underline",children:"צפה באירועים ←"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center",children:e.jsx(je,{className:"w-4 h-4 text-red-500"})}),"מאבטחים שלא עשו צ'ק-אין"]}),((d=s==null?void 0:s.guards_not_checked_in)==null?void 0:d.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.guards_not_checked_in.map(a=>e.jsxs("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-sm text-gray-900",children:[a.first_name," ",a.last_name]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[a.site_name||a.company_name," · ",a.start_time," - ",a.end_time]})]}),a.phone&&e.jsx("a",{href:`tel:${a.phone}`,className:"w-8 h-8 rounded-lg bg-red-50 hover:bg-red-100 flex items-center justify-center transition-colors",title:"התקשר",children:e.jsx(Ve,{className:"w-3.5 h-3.5 text-red-600"})})]},a.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center mx-auto mb-2",children:e.jsx(T,{className:"w-5 h-5 text-emerald-500"})}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"כל המאבטחים עשו צ'ק-אין"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center",children:e.jsx(de,{className:"w-4 h-4 text-amber-600"})}),"אתרים ללא כיסוי"]}),((x=s==null?void 0:s.sites_without_coverage)==null?void 0:x.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.sites_without_coverage.map(a=>e.jsxs("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[a.company_name," · ",a.start_time," - ",a.end_time]}),a.address&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.address})]},a.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center mx-auto mb-2",children:e.jsx(T,{className:"w-5 h-5 text-emerald-500"})}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"כל האתרים מכוסים"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-sky-50 flex items-center justify-center",children:e.jsx(me,{className:"w-4 h-4 text-sky-600"})}),"החלפות משמרות בשעתיים הקרובות"]}),((m=s==null?void 0:s.upcoming_shift_changes)==null?void 0:m.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.upcoming_shift_changes.map(a=>e.jsxs("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:a.site_name||a.company_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[a.start_time," - ",a.end_time," · ",a.assigned_count,"/",a.required_employees," משובצים"]})]}),e.jsx("span",{className:`badge ${a.change_type==="starting"?"badge-success":"badge-warning"}`,children:a.change_type==="starting"?"מתחילה":"מסתיימת"})]},a.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx(me,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"אין החלפות קרובות"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center",children:e.jsx(ee,{className:"w-4 h-4 text-amber-600"})}),"רישיונות והסמכות שפגים ב-7 ימים"]}),((h=s==null?void 0:s.expiring_licenses)==null?void 0:h.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.expiring_licenses.map(a=>e.jsx("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:a.employee_name}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:a.cert_name})]}),e.jsxs("span",{className:`text-xs font-bold px-2.5 py-1 rounded-lg ${a.days_left<=3?"bg-red-50 text-red-600":"bg-amber-50 text-amber-600"}`,children:[a.days_left," ימים"]})]})},a.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center mx-auto mb-2",children:e.jsx(T,{className:"w-5 h-5 text-emerald-500"})}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"אין רישיונות שפגים בקרוב"})]})]}),((i=s==null?void 0:s.today_incidents)==null?void 0:i.length)>0&&e.jsxs("div",{className:"card lg:col-span-2",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center",children:e.jsx(Q,{className:"w-4 h-4 text-red-500"})}),"אירועי אבטחה היום"]}),e.jsx("div",{className:"space-y-2.5",children:s.today_incidents.map(a=>{const g={critical:"bg-red-50 text-red-700 border-red-200",high:"bg-orange-50 text-orange-700 border-orange-200",medium:"bg-amber-50 text-amber-700 border-amber-200",low:"bg-emerald-50 text-emerald-700 border-emerald-200"},f={critical:"קריטי",high:"גבוה",medium:"בינוני",low:"נמוך"};return e.jsx(E,{to:"/incidents",className:"block p-3.5 rounded-xl bg-gray-50/80 border border-gray-100 hover:bg-gray-50 hover:border-gray-200 transition-all",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-xs font-bold border ${g[a.severity]||g.low}`,children:f[a.severity]||a.severity}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:a.title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[a.site_name||a.company_name," · ",a.incident_time]})]})]})},a.id)})})]})]})]})}function rs({data:s,color:t}){return!s||s.length===0?null:e.jsx("div",{className:"w-16 h-8",children:e.jsx(fe,{width:"100%",height:"100%",children:e.jsxs(es,{data:s,margin:{top:2,right:0,left:0,bottom:2},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`spark-${t.replace("#","")}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:t,stopOpacity:.3}),e.jsx("stop",{offset:"100%",stopColor:t,stopOpacity:0})]})}),e.jsx(S,{type:"monotone",dataKey:"value",stroke:t,strokeWidth:1.5,fill:`url(#spark-${t.replace("#","")})`,dot:!1,isAnimationActive:!1})]})})})}function as({change:s}){if(s==null)return null;const t=s>=0;return e.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-medium ${t?"text-emerald-600":"text-red-500"}`,children:[t?e.jsx(re,{className:"w-3 h-3"}):e.jsx(qe,{className:"w-3 h-3"}),Math.abs(s),"%"]})}function ns({data:s,trends:t}){var r,c,l,o,d,x,m,h;const n=[{name:"לידים חדשים",value:((r=s==null?void 0:s.leads)==null?void 0:r.new_leads)||0,icon:ke,iconColor:"text-sky-600",bgColor:"bg-sky-50",href:"/leads?status=new",trendKey:"leads",sparkColor:"#0ea5e9"},{name:"לקוחות פעילים",value:((c=s==null?void 0:s.customers)==null?void 0:c.active_customers)||0,icon:Pe,iconColor:"text-emerald-600",bgColor:"bg-emerald-50",href:"/customers",trendKey:"revenue",sparkColor:"#22c55e"},{name:"משמרות היום",value:((l=s==null?void 0:s.shiftsToday)==null?void 0:l.total)||0,icon:Ce,iconColor:"text-violet-600",bgColor:"bg-violet-50",href:"/shifts",trendKey:"shifts",sparkColor:"#8b5cf6"},{name:"אירועים השבוע",value:((o=s==null?void 0:s.upcomingEvents)==null?void 0:o.length)||0,icon:B,iconColor:"text-amber-600",bgColor:"bg-amber-50",href:"/events",trendKey:"incidents",sparkColor:"#f59e0b"}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6",children:n.map(i=>{const a=t==null?void 0:t[i.trendKey];return e.jsx(E,{to:i.href,className:"stat-card hover:shadow-elevated transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"stat-card-value",children:i.value}),e.jsx(as,{change:a==null?void 0:a.change})]}),e.jsx("p",{className:"stat-card-label",children:i.name})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl ${i.bgColor} flex items-center justify-center`,children:e.jsx(i.icon,{className:`w-5 h-5 ${i.iconColor}`})}),e.jsx(rs,{data:a==null?void 0:a.data,color:i.sparkColor})]})]})},i.name)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-50 flex items-center justify-center",children:e.jsx(re,{className:"w-4 h-4 text-primary-600"})}),"הכנסות - 6 חודשים אחרונים"]}),e.jsx("div",{className:"h-64",children:e.jsx(fe,{width:"100%",height:"100%",children:e.jsxs(Be,{data:(s==null?void 0:s.monthlyRevenue)||[],children:[e.jsx(Te,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(ge,{dataKey:"month",tick:{fontSize:12,fill:"#94a3b8"}}),e.jsx(ye,{tick:{fontSize:12,fill:"#94a3b8"}}),e.jsx(Ke,{formatter:i=>[`₪${i==null?void 0:i.toLocaleString()}`,"הכנסות"],contentStyle:{borderRadius:"12px",border:"1px solid #e2e8f0",boxShadow:"0 4px 16px -2px rgba(0,0,0,0.08)",fontSize:"13px"}}),e.jsx(We,{type:"monotone",dataKey:"revenue",stroke:"#0070cc",strokeWidth:2.5,dot:{r:4,fill:"#0070cc",strokeWidth:2,stroke:"#fff"},activeDot:{r:6}})]})})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center",children:e.jsx(B,{className:"w-4 h-4 text-amber-600"})}),"אירועים קרובים"]}),((d=s==null?void 0:s.upcomingEvents)==null?void 0:d.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.upcomingEvents.map(i=>e.jsx(E,{to:`/events/${i.id}`,className:"block p-3.5 rounded-xl bg-gray-50/80 border border-gray-100 hover:bg-gray-50 hover:border-gray-200 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:i.event_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[i.event_date," · ",i.start_time," · ",i.company_name]})]}),e.jsxs("span",{className:`badge ${i.assigned_count>=i.required_guards?"badge-success":"badge-warning"}`,children:[i.assigned_count,"/",i.required_guards]})]})},i.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx(B,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"אין אירועים קרובים"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center",children:e.jsx(je,{className:"w-4 h-4 text-red-500"})}),"משמרות לא מאוישות היום"]}),((x=s==null?void 0:s.unassignedShifts)==null?void 0:x.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.unassignedShifts.map(i=>e.jsxs("div",{className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100",children:[e.jsxs("p",{className:"font-medium text-sm text-gray-900",children:[i.company_name," - ",i.site_name]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[i.start_time," - ",i.end_time]})]},i.id))}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center mx-auto mb-2",children:e.jsx(T,{className:"w-5 h-5 text-emerald-500"})}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"כל המשמרות מאוישות"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center",children:e.jsx(ee,{className:"w-4 h-4 text-amber-600"})}),"חשבוניות באיחור"]}),e.jsx(E,{to:"/invoices?status=overdue",className:"text-xs text-primary-600 hover:text-primary-700 font-medium",children:"הצג הכל ←"})]}),((m=s==null?void 0:s.overdueInvoices)==null?void 0:m.length)>0?e.jsx("div",{className:"space-y-2.5",children:s.overdueInvoices.map(i=>{var a;return e.jsx(E,{to:"/invoices",className:"block p-3.5 rounded-xl bg-gray-50/80 border border-gray-100 hover:bg-gray-50 hover:border-gray-200 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:i.company_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["חשבונית #",i.invoice_number]})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"font-bold text-sm text-gray-900",children:["₪",(a=i.total_amount)==null?void 0:a.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-red-500 font-medium",children:[i.days_overdue," ימים באיחור"]})]})]})},i.id)})}):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center mx-auto mb-2",children:e.jsx(T,{className:"w-5 h-5 text-emerald-500"})}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"אין חשבוניות באיחור"})]})]}),((h=s==null?void 0:s.contractsExpiring)==null?void 0:h.length)>0&&e.jsxs("div",{className:"card lg:col-span-2",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-sky-50 flex items-center justify-center",children:e.jsx(H,{className:"w-4 h-4 text-sky-600"})}),"חוזים לחידוש בקרוב"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:s.contractsExpiring.map(i=>{var a;return e.jsxs(E,{to:`/customers/${i.customer_id}`,className:"p-3.5 rounded-xl bg-gray-50/80 border border-gray-100 hover:bg-gray-50 hover:border-gray-200 transition-all",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:i.company_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["תום חוזה: ",i.end_date," · ₪",(a=i.monthly_value)==null?void 0:a.toLocaleString(),"/חודש"]})]},i.id)})})]})]})]})}export{ps as default};
