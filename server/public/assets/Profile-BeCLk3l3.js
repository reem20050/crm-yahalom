import{g as C,a as E,r as o,i as F,j as s,a7 as M,z as y,b as L}from"./index-D-jMUT0A.js";import{u as $}from"./index.esm-DprGHt-7.js";import{t as z,o as A,s as d}from"./types-cWvOr9dm.js";import{M as K}from"./mail-PvMCysaY.js";import{S as R}from"./shield-BwdOBKRw.js";import{K as T}from"./key-round-BAQvGyre.js";import{E as m}from"./eye-off-BIC3YRy9.js";import{E as x}from"./eye-BFnmGwk8.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=C("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),b={admin:"מנהל",manager:"מנהל משמרות",employee:"עובד"},I={admin:"badge-danger",manager:"badge-warning",employee:"badge-info"},O=A({currentPassword:d().min(1,"נדרשת סיסמה נוכחית"),newPassword:d().min(6,"סיסמה חדשה חייבת להכיל לפחות 6 תווים"),confirmPassword:d().min(1,"נדרש אישור סיסמה")}).refine(e=>e.newPassword===e.confirmPassword,{message:"הסיסמאות אינן תואמות",path:["confirmPassword"]});function W(){const e=E(r=>r.user),[t,h]=o.useState(!1),[l,p]=o.useState(!1),[n,w]=o.useState(!1),{register:c,handleSubmit:P,reset:v,formState:{errors:a}}=$({resolver:z(O)}),i=F({mutationFn:r=>L.changePassword(r.currentPassword,r.newPassword),onSuccess:()=>{y.success("הסיסמה שונתה בהצלחה"),v(),h(!1),p(!1),w(!1)},onError:r=>{var u,g,N,f;const j=r,k=((g=(u=j.response)==null?void 0:u.data)==null?void 0:g.message)||((f=(N=j.response)==null?void 0:N.data)==null?void 0:f.error)||"שגיאה בשינוי הסיסמה";y.error(k)}}),S=r=>{i.mutate(r)};return e?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"הפרופיל שלי"}),s.jsx("p",{className:"text-gray-500",children:"צפייה בפרטי המשתמש ושינוי סיסמה"})]}),s.jsx("div",{className:"card",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center",children:s.jsx(M,{className:"w-8 h-8 text-primary-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[e.firstName," ",e.lastName]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 text-gray-500",children:[s.jsx(K,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",dir:"ltr",children:e.email})]})]}),s.jsxs("span",{className:`badge ${I[e.role]||"badge-gray"}`,children:[s.jsx(R,{className:"w-3 h-3 ml-1 inline-block"}),b[e.role]||e.role]})]}),s.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"שם פרטי"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.firstName})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"שם משפחה"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.lastName})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"תפקיד"}),s.jsx("p",{className:"font-medium text-gray-900",children:b[e.role]||e.role})]})]})]})]})}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:s.jsx(T,{className:"w-5 h-5 text-amber-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"שינוי סיסמה"}),s.jsx("p",{className:"text-sm text-gray-500",children:"עדכן את הסיסמה שלך לחשבון"})]})]}),s.jsxs("form",{onSubmit:P(S),className:"space-y-5 max-w-md",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"currentPassword",className:"label",children:"סיסמה נוכחית"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"currentPassword",type:t?"text":"password",...c("currentPassword"),className:`input pl-10 ${a.currentPassword?"input-error":""}`,placeholder:"הזן סיסמה נוכחית"}),s.jsx("button",{type:"button",onClick:()=>h(!t),className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t?s.jsx(m,{className:"w-5 h-5"}):s.jsx(x,{className:"w-5 h-5"})})]}),a.currentPassword&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.currentPassword.message})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newPassword",className:"label",children:"סיסמה חדשה"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"newPassword",type:l?"text":"password",...c("newPassword"),className:`input pl-10 ${a.newPassword?"input-error":""}`,placeholder:"לפחות 6 תווים"}),s.jsx("button",{type:"button",onClick:()=>p(!l),className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?s.jsx(m,{className:"w-5 h-5"}):s.jsx(x,{className:"w-5 h-5"})})]}),a.newPassword&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.newPassword.message})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"label",children:"אישור סיסמה חדשה"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"confirmPassword",type:n?"text":"password",...c("confirmPassword"),className:`input pl-10 ${a.confirmPassword?"input-error":""}`,placeholder:"הזן שוב את הסיסמה החדשה"}),s.jsx("button",{type:"button",onClick:()=>w(!n),className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?s.jsx(m,{className:"w-5 h-5"}):s.jsx(x,{className:"w-5 h-5"})})]}),a.confirmPassword&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.confirmPassword.message})]}),s.jsx("div",{className:"pt-2",children:s.jsxs("button",{type:"submit",disabled:i.isPending,className:"btn-primary flex items-center gap-2",children:[s.jsx(B,{className:"w-4 h-4"}),i.isPending?"משנה סיסמה...":"שנה סיסמה"]})})]})]})]}):s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("p",{className:"text-gray-500",children:"לא נמצא משתמש מחובר"})})}export{W as default};
