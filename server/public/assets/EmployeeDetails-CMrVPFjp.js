import{c as z,g as de,r as d,h as N,j as e,X as M,z as c,s as me,k as ge,u as je,d as C,p as ne,A as ye,t as le,v as Ne,n as ve,w as B,q as S,x as _e,y as be}from"./index-BPBwE9NU.js";import{W as fe}from"./WhatsAppButton-CFbEuf00.js";import{S as T}from"./star-BNPVnb_R.js";import{A as we,S as Ce}from"./save-DxeQCaUF.js";import{S as Se}from"./shield-DfQfkLR_.js";import{C as ke}from"./car-BDorhXVV.js";import{P as qe}from"./pen-line-D-cvVisg.js";import{T as ie}from"./trash-2-DgMEGaWc.js";import{P as re}from"./package-DkmrpH_R.js";import{P as ce}from"./plus-BBAlGWpg.js";import{P as Ee}from"./phone-D6d1rIR4.js";import{M as Pe}from"./mail-DlLeOPvh.js";import{M as Fe}from"./map-pin-CrcavfgI.js";import"./message-circle-DTyFQplf.js";import"./send-D3T0BUU3.js";import"./external-link-D20gRu1j.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=z("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=z("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=z("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),$e=[{value:"manager",label:"דירוג מנהל"},{value:"client",label:"דירוג לקוח"},{value:"incident_handling",label:"טיפול באירוע"}];function Ae({employeeId:n,employeeName:k,onClose:x}){const p=de(),[m,D]=d.useState(0),[q,j]=d.useState(0),[b,o]=d.useState("manager"),[$,Y]=d.useState(""),[f,v]=d.useState(""),_=N({mutationFn:l=>me.rate(l),onSuccess:()=>{p.invalidateQueries({queryKey:["performance",n]}),p.invalidateQueries({queryKey:["performance-rankings"]}),c.success("הדירוג נשמר בהצלחה"),x()},onError:()=>c.error("שגיאה בשמירת דירוג")}),i=l=>{if(l.preventDefault(),m===0){c.error("נא לבחור דירוג");return}_.mutate({employee_id:n,rating_type:b,rating:m,shift_id:$||null,comments:f||null})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"דירוג מאבטח"}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[e.jsx("div",{className:"text-center mb-2",children:e.jsx("p",{className:"text-lg font-medium text-gray-900",children:k})}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג דירוג *"}),e.jsx("select",{value:b,onChange:l=>o(l.target.value),className:"input",children:$e.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"דירוג *"}),e.jsx("div",{className:"flex items-center justify-center gap-2 py-3",children:[1,2,3,4,5].map(l=>e.jsx("button",{type:"button",onMouseEnter:()=>j(l),onMouseLeave:()=>j(0),onClick:()=>D(l),className:"transition-transform hover:scale-110",children:e.jsx(T,{className:`w-10 h-10 ${l<=(q||m)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`})},l))}),e.jsxs("p",{className:"text-center text-sm text-gray-500",children:[m===1&&"גרוע",m===2&&"מתחת לממוצע",m===3&&"סביר",m===4&&"טוב",m===5&&"מצוין"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"הערות"}),e.jsx("textarea",{value:f,onChange:l=>v(l.target.value),className:"input min-h-[80px]",placeholder:"הערות על הביצוע..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:_.isPending||m===0,className:"btn-primary flex-1",children:_.isPending?"שומר...":"שמור דירוג"}),e.jsx("button",{type:"button",onClick:x,className:"btn-secondary",children:"ביטול"})]})]})]})})}const Re=[{value:"id_card",label:"תעודת זהות"},{value:"weapon_license",label:"רישיון נשק"},{value:"driving_license",label:"רישיון נהיגה"},{value:"certificate",label:"תעודה"},{value:"other",label:"אחר"}],Ke={id_card:"תעודת זהות",weapon_license:"רישיון נשק",driving_license:"רישיון נהיגה",certificate:"תעודה",other:"אחר"},Le=[{value:"hourly",label:"שעתי"},{value:"monthly",label:"חודשי"},{value:"contractor",label:"קבלן"}],Ie=[{value:"B",label:"B"},{value:"C",label:"C"},{value:"C1",label:"C1"},{value:"D",label:"D"},{value:"D1",label:"D1"}];function ts(){var G,U,W,H,V;const{id:n}=ge(),k=je(),x=de(),[p,m]=d.useState(!1),[D,q]=d.useState(!1),[j,b]=d.useState(!1),[o,$]=d.useState("info"),[Y,f]=d.useState(!1),[v,_]=d.useState(!1),[i,l]=d.useState({cert_type:"firearm_license",cert_name:"",cert_number:"",issuing_authority:"",issue_date:"",expiry_date:"",notes:""}),[t,r]=d.useState({first_name:"",last_name:"",phone:"",email:"",address:"",city:"",hourly_rate:"",employment_type:"",has_weapon_license:!1,has_driving_license:!1,driving_license_type:"",emergency_contact_name:"",emergency_contact_phone:""}),[y,A]=d.useState({document_type:"id_card",expiry_date:""}),{data:u,isLoading:xe}=C({queryKey:["employee",n],queryFn:()=>S.getOne(n).then(s=>s.data),enabled:!!n}),a=u==null?void 0:u.employee,{data:E}=C({queryKey:["certifications",n],queryFn:()=>B.getByEmployee(n).then(s=>s.data),enabled:!!n&&o==="certifications"}),{data:P}=C({queryKey:["weapons",n],queryFn:()=>_e.getByEmployee(n).then(s=>s.data),enabled:!!n&&o==="weapons"}),{data:F}=C({queryKey:["equipment",n],queryFn:()=>be.getByEmployee(n).then(s=>s.data),enabled:!!n&&o==="equipment"}),{data:h}=C({queryKey:["performance",n],queryFn:()=>me.getEmployee(n).then(s=>s.data),enabled:!!n&&o==="performance"}),R=N({mutationFn:s=>B.create(s),onSuccess:()=>{x.invalidateQueries({queryKey:["certifications",n]}),c.success("הסמכה נוספה בהצלחה"),_(!1),l({cert_type:"firearm_license",cert_name:"",cert_number:"",issuing_authority:"",issue_date:"",expiry_date:"",notes:""})},onError:()=>c.error("שגיאה בהוספת הסמכה")}),oe=N({mutationFn:s=>B.delete(s),onSuccess:()=>{x.invalidateQueries({queryKey:["certifications",n]}),c.success("הסמכה נמחקה")},onError:()=>c.error("שגיאה במחיקה")});d.useEffect(()=>{var s;a&&r({first_name:a.first_name||"",last_name:a.last_name||"",phone:a.phone||"",email:a.email||"",address:a.address||"",city:a.city||"",hourly_rate:((s=a.hourly_rate)==null?void 0:s.toString())||"",employment_type:a.employment_type||"hourly",has_weapon_license:!!a.has_weapon_license,has_driving_license:!!a.has_driving_license,driving_license_type:a.driving_license_type||"",emergency_contact_name:a.emergency_contact_name||"",emergency_contact_phone:a.emergency_contact_phone||""})},[a]);const K=N({mutationFn:s=>S.update(n,s),onSuccess:()=>{x.invalidateQueries({queryKey:["employee",n]}),x.invalidateQueries({queryKey:["employees"]}),c.success("העובד עודכן בהצלחה"),m(!1)},onError:()=>c.error("שגיאה בעדכון העובד")}),L=N({mutationFn:()=>{const s=(a==null?void 0:a.status)==="active"?"inactive":"active";return S.update(n,{status:s})},onSuccess:()=>{x.invalidateQueries({queryKey:["employee",n]}),x.invalidateQueries({queryKey:["employees"]});const s=(a==null?void 0:a.status)==="active"?"לא פעיל":"פעיל";c.success(`סטטוס העובד שונה ל${s}`)},onError:()=>c.error("שגיאה בשינוי סטטוס")}),I=N({mutationFn:()=>S.delete(n),onSuccess:()=>{x.invalidateQueries({queryKey:["employees"]}),c.success("העובד נמחק בהצלחה"),k("/employees")},onError:()=>c.error("שגיאה במחיקת העובד")}),Q=N({mutationFn:s=>S.addDocument(n,s),onSuccess:()=>{x.invalidateQueries({queryKey:["employee",n]}),c.success("מסמך נוסף בהצלחה"),b(!1),A({document_type:"id_card",expiry_date:""})},onError:()=>c.error("שגיאה בהוספת מסמך")}),he=()=>{const s={...t,hourly_rate:t.hourly_rate?Number(t.hourly_rate):null};K.mutate(s)},ue=()=>{var s;a&&r({first_name:a.first_name||"",last_name:a.last_name||"",phone:a.phone||"",email:a.email||"",address:a.address||"",city:a.city||"",hourly_rate:((s=a.hourly_rate)==null?void 0:s.toString())||"",employment_type:a.employment_type||"hourly",has_weapon_license:!!a.has_weapon_license,has_driving_license:!!a.has_driving_license,driving_license_type:a.driving_license_type||"",emergency_contact_name:a.emergency_contact_name||"",emergency_contact_phone:a.emergency_contact_phone||""}),m(!1)},pe=s=>{s.preventDefault(),Q.mutate({document_type:y.document_type,expiry_date:y.expiry_date||null})};return xe?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>k("/employees"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(we,{className:"w-5 h-5"}),"חזרה לעובדים"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(ne,{className:"w-12 h-12 text-gray-400"})}),e.jsxs("div",{children:[p?e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{value:t.first_name,onChange:s=>r({...t,first_name:s.target.value}),className:"input text-xl font-bold w-40",placeholder:"שם פרטי"}),e.jsx("input",{value:t.last_name,onChange:s=>r({...t,last_name:s.target.value}),className:"input text-xl font-bold w-40",placeholder:"שם משפחה"})]}):e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:`badge ${(a==null?void 0:a.status)==="active"?"badge-success":"badge-gray"}`,children:(a==null?void 0:a.status)==="active"?"פעיל":"לא פעיל"}),(a==null?void 0:a.has_weapon_license)&&e.jsxs("span",{className:"badge badge-info flex items-center gap-1",children:[e.jsx(Se,{className:"w-3 h-3"}),"רישיון נשק"]}),(a==null?void 0:a.has_driving_license)&&e.jsxs("span",{className:"badge badge-gray flex items-center gap-1",children:[e.jsx(ke,{className:"w-3 h-3"}),"רישיון ",a.driving_license_type]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:he,disabled:K.isPending,className:"btn-success text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),K.isPending?"שומר...":"שמור"]}),e.jsxs("button",{onClick:ue,className:"btn-secondary text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(M,{className:"w-4 h-4"}),"ביטול"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(qe,{className:"w-4 h-4"}),"עריכה"]}),e.jsxs("button",{onClick:()=>L.mutate(),disabled:L.isPending,className:"btn-secondary text-sm flex items-center gap-1 px-3 py-2",title:(a==null?void 0:a.status)==="active"?"העבר ללא פעיל":"הפעל עובד",children:[(a==null?void 0:a.status)==="active"?e.jsx(De,{className:"w-4 h-4 text-green-600"}):e.jsx(Te,{className:"w-4 h-4 text-gray-400"}),L.isPending?"מעדכן...":(a==null?void 0:a.status)==="active"?"השבת":"הפעל"]}),e.jsxs("button",{onClick:()=>q(!0),className:"btn-danger text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"מחק עובד"]})]})})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ye,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"מחיקת עובד"}),e.jsx("p",{className:"text-sm text-gray-500",children:"פעולה זו אינה ניתנת לביטול"})]})]}),e.jsxs("p",{className:"text-gray-700 mb-6",children:["האם אתה בטוח שברצונך למחוק את העובד"," ",e.jsxs("strong",{children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),"? כל הנתונים הקשורים לעובד זה יימחקו לצמיתות."]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[e.jsx("button",{onClick:()=>q(!1),className:"btn-secondary px-4 py-2",children:"ביטול"}),e.jsx("button",{onClick:()=>I.mutate(),disabled:I.isPending,className:"btn-danger px-4 py-2",children:I.isPending?"מוחק...":"מחק עובד"})]})]})}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex gap-4",children:[{id:"info",label:"מידע כללי",icon:ne},{id:"certifications",label:"הסמכות",icon:Me},{id:"weapons",label:"נשק",icon:le},{id:"equipment",label:"ציוד",icon:re},{id:"performance",label:"ביצועים",icon:Ne}].map(s=>e.jsxs("button",{onClick:()=>$(s.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors text-sm ${o===s.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label]},s.id))})}),o==="certifications"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"הסמכות ורישיונות"}),e.jsxs("button",{onClick:()=>_(!v),className:"btn-primary text-sm flex items-center gap-1",children:[v?e.jsx(M,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"}),v?"ביטול":"הוסף הסמכה"]})]}),v&&e.jsxs("form",{onSubmit:s=>{s.preventDefault(),R.mutate({...i,employee_id:n})},className:"card space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג הסמכה *"}),e.jsxs("select",{value:i.cert_type,onChange:s=>l({...i,cert_type:s.target.value}),className:"input",children:[e.jsx("option",{value:"firearm_license",children:"רישיון נשק"}),e.jsx("option",{value:"security_officer",children:"קצין ביטחון"}),e.jsx("option",{value:"first_aid",children:"עזרה ראשונה"}),e.jsx("option",{value:"fire_safety",children:"בטיחות אש"}),e.jsx("option",{value:"driving_license",children:"רישיון נהיגה"}),e.jsx("option",{value:"guard_license",children:"רישיון שמירה"}),e.jsx("option",{value:"other",children:"אחר"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם ההסמכה *"}),e.jsx("input",{value:i.cert_name,onChange:s=>l({...i,cert_name:s.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"מספר תעודה"}),e.jsx("input",{value:i.cert_number,onChange:s=>l({...i,cert_number:s.target.value}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"גוף מנפיק"}),e.jsx("input",{value:i.issuing_authority,onChange:s=>l({...i,issuing_authority:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך הנפקה"}),e.jsx("input",{type:"date",value:i.issue_date,onChange:s=>l({...i,issue_date:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך תפוגה"}),e.jsx("input",{type:"date",value:i.expiry_date,onChange:s=>l({...i,expiry_date:s.target.value}),className:"input"})]})]}),e.jsx("button",{type:"submit",disabled:R.isPending,className:"btn-primary text-sm",children:R.isPending?"שומר...":"שמור הסמכה"})]}),((G=E==null?void 0:E.certifications)==null?void 0:G.length)>0?e.jsx("div",{className:"space-y-2",children:E.certifications.map(s=>{const w=s.expiry_status==="expired"?"bg-red-100 border-red-300 text-red-800":s.expiry_status==="expiring_soon"?"bg-yellow-100 border-yellow-300 text-yellow-800":s.expiry_status==="expiring"?"bg-orange-50 border-orange-200 text-orange-700":"bg-green-50 border-green-200 text-green-800",O={expired:"פג תוקף",expiring_soon:"פג בקרוב (<30 יום)",expiring:"פג ב-60 יום",valid:"בתוקף",no_expiry:"ללא תפוגה"};return e.jsx("div",{className:`p-3 rounded-lg border ${w}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.cert_name}),e.jsxs("p",{className:"text-sm opacity-80",children:[s.cert_number&&`מס׳ ${s.cert_number} | `,s.issuing_authority||""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium",children:O[s.expiry_status||"valid"]}),s.expiry_date&&e.jsx("span",{className:"text-xs opacity-70",children:s.expiry_date}),e.jsx("button",{onClick:()=>oe.mutate(s.id),className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-100",children:e.jsx(ie,{className:"w-3.5 h-3.5"})})]})]})},s.id)})}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"אין הסמכות רשומות"})]}),o==="weapons"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"נשק מוקצה"}),((U=P==null?void 0:P.weapons)==null?void 0:U.length)>0?e.jsx("div",{className:"space-y-2",children:P.weapons.map(s=>e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.weapon_type," ",s.manufacturer&&`- ${s.manufacturer}`," ",s.model||""]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["מס״ס: ",s.serial_number]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`badge ${s.status==="assigned"?"badge-success":s.status==="maintenance"?"badge-warning":"badge-gray"}`,children:s.status==="assigned"?"מוקצה":s.status==="maintenance"?"בתחזוקה":"במחסן"}),s.license_expiry&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["רישיון: ",s.license_expiry]})]})]})},s.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"אין נשק מוקצה"})]}),o==="equipment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"ציוד מוקצה"}),((W=F==null?void 0:F.equipment)==null?void 0:W.length)>0?e.jsx("div",{className:"space-y-2",children:F.equipment.map(s=>{const w={new:"חדש",good:"תקין",fair:"סביר",needs_repair:"דורש תיקון",damaged:"פגום"};return e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(re,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.item_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.item_type,s.serial_number&&` | מס"ס: ${s.serial_number}`]}),s.assigned_date&&e.jsxs("p",{className:"text-xs text-gray-400",children:["מאז: ",s.assigned_date]})]})]}),e.jsx("span",{className:`badge ${s.condition==="good"||s.condition==="new"?"badge-success":s.condition==="fair"?"badge-warning":"badge-danger"}`,children:w[s.condition]||s.condition})]})},s.id)})}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"אין ציוד מוקצה"})]}),o==="performance"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"ביצועים"}),e.jsxs("button",{onClick:()=>f(!0),className:"btn-primary text-sm flex items-center gap-1",children:[e.jsx(T,{className:"w-4 h-4"}),"דרג מאבטח"]})]}),h&&(()=>{var X,J,Z,ee,se,ae;const s=((X=h.ratings)==null?void 0:X.avg_rating)||0,w=((J=h.ratings)==null?void 0:J.total_ratings)||0,O=((Z=h.attendance)==null?void 0:Z.rate)||0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:[1,2,3,4,5].map(g=>e.jsx(T,{className:`w-4 h-4 ${g<=Math.round(s)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},g))}),e.jsx("p",{className:"text-2xl font-bold",children:Number(s).toFixed(1)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["דירוג ממוצע (",w," דירוגים)"]})]}),e.jsxs("div",{className:"card text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[O,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"נוכחות"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:h.total_hours||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"שעות (3 חודשים)"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:h.shifts_this_month||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"משמרות החודש"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-medium mb-2",children:"סטטיסטיקות"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-gray-500",children:"אירועי אבטחה דווחו"}),e.jsx("dd",{className:"font-medium",children:h.incidents_reported||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-gray-500",children:"סיורים שהושלמו"}),e.jsx("dd",{className:"font-medium",children:h.total_patrols||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-gray-500",children:"משמרות הגיע"}),e.jsxs("dd",{className:"font-medium",children:[((ee=h.attendance)==null?void 0:ee.checked_in)||0,"/",((se=h.attendance)==null?void 0:se.total_assignments)||0]})]})]})]}),((ae=h.recent_ratings)==null?void 0:ae.length)>0&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-medium mb-2",children:"דירוגים אחרונים"}),e.jsx("div",{className:"space-y-2",children:h.recent_ratings.slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(te=>e.jsx(T,{className:`w-3 h-3 ${te<=g.rating?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},te)),e.jsx("span",{className:"text-xs text-gray-500 mr-2",children:g.rating_type==="manager_review"?"מנהל":g.rating_type==="customer_feedback"?"לקוח":"אירוע"})]}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(g.created_at).toLocaleDateString("he-IL")})]},g.id))})]})]})]})})()]}),Y&&a&&e.jsx(Ae,{employeeId:n,employeeName:`${a.first_name} ${a.last_name}`,onClose:()=>f(!1)}),o==="info"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"פרטי קשר"}),p?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון"}),e.jsx("input",{value:t.phone,onChange:s=>r({...t,phone:s.target.value}),className:"input",dir:"ltr",placeholder:"050-0000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"אימייל"}),e.jsx("input",{value:t.email,onChange:s=>r({...t,email:s.target.value}),className:"input",dir:"ltr",type:"email",placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"כתובת"}),e.jsx("input",{value:t.address,onChange:s=>r({...t,address:s.target.value}),className:"input",placeholder:"רחוב ומספר"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"עיר"}),e.jsx("input",{value:t.city,onChange:s=>r({...t,city:s.target.value}),className:"input",placeholder:"עיר"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"טלפון"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:`tel:${a==null?void 0:a.phone}`,className:"text-primary-600 font-medium",children:a==null?void 0:a.phone}),(a==null?void 0:a.phone)&&e.jsx(fe,{phone:a.phone,name:`${a.first_name||""} ${a.last_name||""}`.trim()||"עובד",size:"sm"})]})]})]}),(a==null?void 0:a.email)&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"אימייל"}),e.jsx("a",{href:`mailto:${a.email}`,className:"text-primary-600 font-medium",children:a.email})]})]}),(a==null?void 0:a.address)&&e.jsxs("div",{className:"flex items-center gap-3 col-span-2",children:[e.jsx(Fe,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"כתובת"}),e.jsxs("p",{className:"font-medium",children:[a.address,", ",a.city]})]})]})]})]}),p&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"פרטי העסקה - עריכה"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג העסקה"}),e.jsx("select",{value:t.employment_type,onChange:s=>r({...t,employment_type:s.target.value}),className:"input",children:Le.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שכר שעתי (₪)"}),e.jsx("input",{type:"number",value:t.hourly_rate,onChange:s=>r({...t,hourly_rate:s.target.value}),className:"input",dir:"ltr",placeholder:"0"})]}),e.jsxs("div",{className:"col-span-2 flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.has_weapon_license,onChange:s=>r({...t,has_weapon_license:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("span",{children:"רישיון נשק"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.has_driving_license,onChange:s=>r({...t,has_driving_license:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("span",{children:"רישיון נהיגה"})]}),t.has_driving_license&&e.jsxs("select",{value:t.driving_license_type,onChange:s=>r({...t,driving_license_type:s.target.value}),className:"input w-auto",children:[e.jsx("option",{value:"",children:"סוג רישיון"}),Ie.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]})]})]}),p&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"איש קשר לחירום - עריכה"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם איש קשר"}),e.jsx("input",{value:t.emergency_contact_name,onChange:s=>r({...t,emergency_contact_name:s.target.value}),className:"input",placeholder:"שם מלא"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון חירום"}),e.jsx("input",{value:t.emergency_contact_phone,onChange:s=>r({...t,emergency_contact_phone:s.target.value}),className:"input",dir:"ltr",placeholder:"050-0000000"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"משמרות אחרונות"}),((H=u==null?void 0:u.recentShifts)==null?void 0:H.length)>0?e.jsx("div",{className:"space-y-2",children:u.recentShifts.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.company_name," - ",s.site_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.date," | ",s.start_time," - ",s.end_time]})]}),s.actual_hours&&e.jsxs("span",{className:"text-sm text-gray-500",children:[s.actual_hours," שעות"]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"אין משמרות"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"פרטי העסקה"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"ת.ז"}),e.jsx("dd",{className:"font-medium",children:a==null?void 0:a.id_number})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"תאריך התחלה"}),e.jsx("dd",{className:"font-medium",children:a==null?void 0:a.hire_date})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"סוג העסקה"}),e.jsx("dd",{className:"font-medium",children:(a==null?void 0:a.employment_type)==="hourly"?"שעתי":(a==null?void 0:a.employment_type)==="monthly"?"חודשי":"קבלן"})]}),(a==null?void 0:a.hourly_rate)&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"שכר שעתי"}),e.jsxs("dd",{className:"font-medium",children:["₪",a.hourly_rate]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"מסמכים"}),e.jsxs("button",{onClick:()=>b(!j),className:"btn-primary text-sm flex items-center gap-1 px-3 py-1.5",children:[j?e.jsx(M,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"}),j?"ביטול":"הוסף מסמך"]})]}),j&&e.jsxs("form",{onSubmit:pe,className:"mb-4 p-4 bg-blue-50 rounded-lg space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג מסמך *"}),e.jsx("select",{value:y.document_type,onChange:s=>A({...y,document_type:s.target.value}),className:"input",required:!0,children:Re.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך תפוגה"}),e.jsx("input",{type:"date",value:y.expiry_date,onChange:s=>A({...y,expiry_date:s.target.value}),className:"input"})]}),e.jsx("button",{type:"submit",disabled:Q.isPending||!y.document_type,className:"btn-primary text-sm",children:Q.isPending?"שומר...":"שמור מסמך"})]}),((V=u==null?void 0:u.documents)==null?void 0:V.length)>0?e.jsx("div",{className:"space-y-2",children:u.documents.map(s=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:Ke[s.document_type]||s.document_type})]}),s.expiry_date&&e.jsx("span",{className:"text-gray-500",children:s.expiry_date})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-sm text-center",children:"אין מסמכים"})]}),!p&&(a==null?void 0:a.emergency_contact_name)&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"איש קשר לחירום"}),e.jsx("p",{className:"font-medium",children:a.emergency_contact_name}),e.jsx("a",{href:`tel:${a.emergency_contact_phone}`,className:"text-primary-600 text-sm",children:a.emergency_contact_phone})]})]})]})]})}export{ts as default};
