import{x as z,c as me,r as d,d as y,j as e,X as D,z as r,K as oe,D as ye,u as Ne,e as k,I as le,S as ve,A as fe,M as ie,N as _e,E as be,O as B,J as _,Q as we,T as Ce}from"./index-DNhSfFTF.js";import{W as Se}from"./WhatsAppButton-CMz-ehNn.js";import{S as E}from"./star-Bi8HfDq8.js";import{D as ke}from"./DocumentManager-DgenNX-Z.js";import{A as Ee,S as qe}from"./save-DJuc85Nt.js";import{C as Pe}from"./car-BCPsmmPr.js";import{P as Fe}from"./pen-line-CTwFjm8c.js";import{T as Y}from"./trash-2-C8JFUyr_.js";import{P as re}from"./package-UtShABcj.js";import{P as ce}from"./plus-42YS-w1A.js";import{P as Me}from"./phone-C6GpoGt1.js";import{M as Te}from"./mail-elckFBEn.js";import{M as De}from"./map-pin-CnrXv9DV.js";import"./message-circle-CWw4z9y6.js";import"./external-link-BplGfNjn.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=z("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=z("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=z("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),Re=[{value:"manager",label:"דירוג מנהל"},{value:"client",label:"דירוג לקוח"},{value:"incident_handling",label:"טיפול באירוע"}],de={1:{text:"גרוע",color:"text-red-500"},2:{text:"מתחת לממוצע",color:"text-orange-500"},3:{text:"סביר",color:"text-yellow-500"},4:{text:"טוב",color:"text-blue-500"},5:{text:"מצוין",color:"text-green-500"}};function Le({employeeId:t,employeeName:q,onClose:m}){var n,i;const g=me(),[p,$]=d.useState(0),[P,N]=d.useState(0),[b,o]=d.useState("manager"),[A,G]=d.useState(""),[w,v]=d.useState(""),f=y({mutationFn:l=>oe.rate(l),onSuccess:()=>{g.invalidateQueries({queryKey:["performance",t]}),g.invalidateQueries({queryKey:["performance-rankings"]}),r.success("הדירוג נשמר בהצלחה"),m()},onError:()=>r.error("שגיאה בשמירת דירוג")}),c=l=>{if(l.preventDefault(),p===0){r.error("נא לבחור דירוג");return}f.mutate({employee_id:t,rating_type:b,rating:p,shift_id:A||null,comments:w||null})},x=P||p;return e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-yellow-100 to-amber-50 flex items-center justify-center",children:e.jsx(E,{className:"w-5 h-5 text-yellow-600"})}),e.jsx("h2",{className:"text-xl font-bold font-heading",children:"דירוג מאבטח"})]}),e.jsx("button",{onClick:m,className:"btn-icon",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:c,className:"p-6 space-y-4",children:[e.jsx("div",{className:"text-center mb-2",children:e.jsx("p",{className:"text-lg font-semibold font-heading text-gray-900",children:q})}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג דירוג *"}),e.jsx("select",{value:b,onChange:l=>o(l.target.value),className:"input",children:Re.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"דירוג *"}),e.jsx("div",{className:"flex items-center justify-center gap-3 py-4",children:[1,2,3,4,5].map(l=>{const C=l<=x;return e.jsx("button",{type:"button",onMouseEnter:()=>N(l),onMouseLeave:()=>N(0),onClick:()=>$(l),className:"transition-all duration-200 hover:scale-125 active:scale-95",children:e.jsx(E,{className:`w-10 h-10 transition-colors duration-150 ${C?"text-yellow-400 fill-yellow-400 drop-shadow-[0_0_6px_rgba(250,204,21,0.4)]":"text-gray-200 hover:text-gray-300"}`})},l)})}),x>0&&e.jsx("p",{className:`text-center text-sm font-semibold font-heading ${((n=de[x])==null?void 0:n.color)||"text-gray-500"}`,children:(i=de[x])==null?void 0:i.text})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"הערות"}),e.jsx("textarea",{value:w,onChange:l=>v(l.target.value),className:"input min-h-[80px]",placeholder:"הערות על הביצוע..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:f.isPending||p===0,className:"btn-primary flex-1",children:f.isPending?"שומר...":"שמור דירוג"}),e.jsx("button",{type:"button",onClick:m,className:"btn-ghost",children:"ביטול"})]})]})]})})}const Ie=[{value:"id_card",label:"תעודת זהות"},{value:"weapon_license",label:"רישיון נשק"},{value:"driving_license",label:"רישיון נהיגה"},{value:"certificate",label:"תעודה"},{value:"other",label:"אחר"}],Qe={id_card:"תעודת זהות",weapon_license:"רישיון נשק",driving_license:"רישיון נהיגה",certificate:"תעודה",other:"אחר"},Oe=[{value:"hourly",label:"שעתי"},{value:"monthly",label:"חודשי"},{value:"contractor",label:"קבלן"}],Be=[{value:"B",label:"B"},{value:"C",label:"C"},{value:"C1",label:"C1"},{value:"D",label:"D"},{value:"D1",label:"D1"}];function ls(){var U,W,H,J,V;const{id:t}=ye(),q=Ne(),m=me(),[g,p]=d.useState(!1),[$,P]=d.useState(!1),[N,b]=d.useState(!1),[o,A]=d.useState("info"),[G,w]=d.useState(!1),[v,f]=d.useState(!1),[c,x]=d.useState({cert_type:"firearm_license",cert_name:"",cert_number:"",issuing_authority:"",issue_date:"",expiry_date:"",notes:""}),[n,i]=d.useState({first_name:"",last_name:"",phone:"",email:"",address:"",city:"",hourly_rate:"",employment_type:"",has_weapon_license:!1,has_driving_license:!1,driving_license_type:"",emergency_contact_name:"",emergency_contact_phone:""}),[l,C]=d.useState({document_type:"id_card",expiry_date:""}),{data:u,isLoading:xe}=k({queryKey:["employee",t],queryFn:()=>_.getOne(t).then(s=>s.data),enabled:!!t}),a=u==null?void 0:u.employee,{data:F}=k({queryKey:["certifications",t],queryFn:()=>B.getByEmployee(t).then(s=>s.data),enabled:!!t&&o==="certifications"}),{data:M}=k({queryKey:["weapons",t],queryFn:()=>we.getByEmployee(t).then(s=>s.data),enabled:!!t&&o==="weapons"}),{data:T}=k({queryKey:["equipment",t],queryFn:()=>Ce.getByEmployee(t).then(s=>s.data),enabled:!!t&&o==="equipment"}),{data:h}=k({queryKey:["performance",t],queryFn:()=>oe.getEmployee(t).then(s=>s.data),enabled:!!t&&o==="performance"}),K=y({mutationFn:s=>B.create(s),onSuccess:()=>{m.invalidateQueries({queryKey:["certifications",t]}),r.success("הסמכה נוספה בהצלחה"),f(!1),x({cert_type:"firearm_license",cert_name:"",cert_number:"",issuing_authority:"",issue_date:"",expiry_date:"",notes:""})},onError:()=>r.error("שגיאה בהוספת הסמכה")}),he=y({mutationFn:s=>B.delete(s),onSuccess:()=>{m.invalidateQueries({queryKey:["certifications",t]}),r.success("הסמכה נמחקה")},onError:()=>r.error("שגיאה במחיקה")});d.useEffect(()=>{var s;a&&i({first_name:a.first_name||"",last_name:a.last_name||"",phone:a.phone||"",email:a.email||"",address:a.address||"",city:a.city||"",hourly_rate:((s=a.hourly_rate)==null?void 0:s.toString())||"",employment_type:a.employment_type||"hourly",has_weapon_license:!!a.has_weapon_license,has_driving_license:!!a.has_driving_license,driving_license_type:a.driving_license_type||"",emergency_contact_name:a.emergency_contact_name||"",emergency_contact_phone:a.emergency_contact_phone||""})},[a]);const R=y({mutationFn:s=>_.update(t,s),onSuccess:()=>{m.invalidateQueries({queryKey:["employee",t]}),m.invalidateQueries({queryKey:["employees"]}),r.success("העובד עודכן בהצלחה"),p(!1)},onError:()=>r.error("שגיאה בעדכון העובד")}),L=y({mutationFn:()=>{const s=(a==null?void 0:a.status)==="active"?"inactive":"active";return _.update(t,{status:s})},onSuccess:()=>{m.invalidateQueries({queryKey:["employee",t]}),m.invalidateQueries({queryKey:["employees"]});const s=(a==null?void 0:a.status)==="active"?"לא פעיל":"פעיל";r.success(`סטטוס העובד שונה ל${s}`)},onError:()=>r.error("שגיאה בשינוי סטטוס")}),I=y({mutationFn:()=>_.delete(t),onSuccess:()=>{m.invalidateQueries({queryKey:["employees"]}),r.success("העובד נמחק בהצלחה"),q("/employees")},onError:()=>r.error("שגיאה במחיקת העובד")}),Q=y({mutationFn:s=>_.addDocument(t,s),onSuccess:()=>{m.invalidateQueries({queryKey:["employee",t]}),r.success("מסמך נוסף בהצלחה"),b(!1),C({document_type:"id_card",expiry_date:""})},onError:()=>r.error("שגיאה בהוספת מסמך")}),ue=y({mutationFn:s=>_.deleteDocument(t,s),onSuccess:()=>{m.invalidateQueries({queryKey:["employee",t]}),r.success("מסמך נמחק בהצלחה")},onError:()=>r.error("שגיאה במחיקת מסמך")}),ge=()=>{const s={...n,hourly_rate:n.hourly_rate?Number(n.hourly_rate):null};R.mutate(s)},pe=()=>{var s;a&&i({first_name:a.first_name||"",last_name:a.last_name||"",phone:a.phone||"",email:a.email||"",address:a.address||"",city:a.city||"",hourly_rate:((s=a.hourly_rate)==null?void 0:s.toString())||"",employment_type:a.employment_type||"hourly",has_weapon_license:!!a.has_weapon_license,has_driving_license:!!a.has_driving_license,driving_license_type:a.driving_license_type||"",emergency_contact_name:a.emergency_contact_name||"",emergency_contact_phone:a.emergency_contact_phone||""}),p(!1)},je=s=>{s.preventDefault(),Q.mutate({document_type:l.document_type,expiry_date:l.expiry_date||null})};return xe?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>q("/employees"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(Ee,{className:"w-5 h-5"}),"חזרה לעובדים"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-primary-100 to-primary-50 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"w-12 h-12 text-gray-400"})}),e.jsxs("div",{children:[g?e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{value:n.first_name,onChange:s=>i({...n,first_name:s.target.value}),className:"input text-xl font-bold w-40",placeholder:"שם פרטי"}),e.jsx("input",{value:n.last_name,onChange:s=>i({...n,last_name:s.target.value}),className:"input text-xl font-bold w-40",placeholder:"שם משפחה"})]}):e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 font-heading",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:`badge ${(a==null?void 0:a.status)==="active"?"badge-success":"badge-gray"}`,children:(a==null?void 0:a.status)==="active"?"פעיל":"לא פעיל"}),(a==null?void 0:a.has_weapon_license)&&e.jsxs("span",{className:"badge badge-info flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),"רישיון נשק"]}),(a==null?void 0:a.has_driving_license)&&e.jsxs("span",{className:"badge badge-gray flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3 h-3"}),"רישיון ",a.driving_license_type]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:ge,disabled:R.isPending,className:"btn-success text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(qe,{className:"w-4 h-4"}),R.isPending?"שומר...":"שמור"]}),e.jsxs("button",{onClick:pe,className:"btn-secondary text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(D,{className:"w-4 h-4"}),"ביטול"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>p(!0),className:"btn-primary text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),"עריכה"]}),e.jsxs("button",{onClick:()=>L.mutate(),disabled:L.isPending,className:"btn-secondary text-sm flex items-center gap-1 px-3 py-2",title:(a==null?void 0:a.status)==="active"?"העבר ללא פעיל":"הפעל עובד",children:[(a==null?void 0:a.status)==="active"?e.jsx(Ke,{className:"w-4 h-4 text-green-600"}):e.jsx(Ae,{className:"w-4 h-4 text-gray-400"}),L.isPending?"מעדכן...":(a==null?void 0:a.status)==="active"?"השבת":"הפעל"]}),e.jsxs("button",{onClick:()=>P(!0),className:"btn-danger text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"מחק עובד"]})]})})]}),$&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(fe,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 font-heading",children:"מחיקת עובד"}),e.jsx("p",{className:"text-sm text-gray-500",children:"פעולה זו אינה ניתנת לביטול"})]})]}),e.jsxs("p",{className:"text-gray-700 mb-6",children:["האם אתה בטוח שברצונך למחוק את העובד"," ",e.jsxs("strong",{children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),"? כל הנתונים הקשורים לעובד זה יימחקו לצמיתות."]}),e.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[e.jsx("button",{onClick:()=>P(!1),className:"btn-secondary px-4 py-2",children:"ביטול"}),e.jsx("button",{onClick:()=>I.mutate(),disabled:I.isPending,className:"btn-danger px-4 py-2",children:I.isPending?"מוחק...":"מחק עובד"})]})]})}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex gap-4",children:[{id:"info",label:"מידע כללי",icon:le},{id:"certifications",label:"הסמכות",icon:$e},{id:"weapons",label:"נשק",icon:ie},{id:"equipment",label:"ציוד",icon:re},{id:"performance",label:"ביצועים",icon:_e}].map(s=>e.jsxs("button",{onClick:()=>A(s.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors text-sm ${o===s.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label]},s.id))})}),o==="certifications"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold font-heading",children:"הסמכות ורישיונות"}),e.jsxs("button",{onClick:()=>f(!v),className:"btn-primary text-sm flex items-center gap-1",children:[v?e.jsx(D,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"}),v?"ביטול":"הוסף הסמכה"]})]}),v&&e.jsxs("form",{onSubmit:s=>{s.preventDefault(),K.mutate({...c,employee_id:t})},className:"card space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג הסמכה *"}),e.jsxs("select",{value:c.cert_type,onChange:s=>x({...c,cert_type:s.target.value}),className:"input",children:[e.jsx("option",{value:"firearm_license",children:"רישיון נשק"}),e.jsx("option",{value:"security_officer",children:"קצין ביטחון"}),e.jsx("option",{value:"first_aid",children:"עזרה ראשונה"}),e.jsx("option",{value:"fire_safety",children:"בטיחות אש"}),e.jsx("option",{value:"driving_license",children:"רישיון נהיגה"}),e.jsx("option",{value:"guard_license",children:"רישיון שמירה"}),e.jsx("option",{value:"other",children:"אחר"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם ההסמכה *"}),e.jsx("input",{value:c.cert_name,onChange:s=>x({...c,cert_name:s.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"מספר תעודה"}),e.jsx("input",{value:c.cert_number,onChange:s=>x({...c,cert_number:s.target.value}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"גוף מנפיק"}),e.jsx("input",{value:c.issuing_authority,onChange:s=>x({...c,issuing_authority:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך הנפקה"}),e.jsx("input",{type:"date",value:c.issue_date,onChange:s=>x({...c,issue_date:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך תפוגה"}),e.jsx("input",{type:"date",value:c.expiry_date,onChange:s=>x({...c,expiry_date:s.target.value}),className:"input"})]})]}),e.jsx("button",{type:"submit",disabled:K.isPending,className:"btn-primary text-sm",children:K.isPending?"שומר...":"שמור הסמכה"})]}),((U=F==null?void 0:F.certifications)==null?void 0:U.length)>0?e.jsx("div",{className:"space-y-2",children:F.certifications.map(s=>{const S=s.expiry_status==="expired"?"bg-red-100 border-red-300 text-red-800":s.expiry_status==="expiring_soon"?"bg-yellow-100 border-yellow-300 text-yellow-800":s.expiry_status==="expiring"?"bg-orange-50 border-orange-200 text-orange-700":"bg-green-50 border-green-200 text-green-800",O={expired:"פג תוקף",expiring_soon:"פג בקרוב (<30 יום)",expiring:"פג ב-60 יום",valid:"בתוקף",no_expiry:"ללא תפוגה"};return e.jsx("div",{className:`p-3 rounded-lg border ${S}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.cert_name}),e.jsxs("p",{className:"text-sm opacity-80",children:[s.cert_number&&`מס׳ ${s.cert_number} | `,s.issuing_authority||""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium",children:O[s.expiry_status||"valid"]}),s.expiry_date&&e.jsx("span",{className:"text-xs opacity-70",children:s.expiry_date}),e.jsx("button",{onClick:()=>he.mutate(s.id),className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-100",children:e.jsx(Y,{className:"w-3.5 h-3.5"})})]})]})},s.id)})}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"אין הסמכות רשומות"})]}),o==="weapons"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold font-heading",children:"נשק מוקצה"}),((W=M==null?void 0:M.weapons)==null?void 0:W.length)>0?e.jsx("div",{className:"space-y-2",children:M.weapons.map(s=>e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.weapon_type," ",s.manufacturer&&`- ${s.manufacturer}`," ",s.model||""]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["מס״ס: ",s.serial_number]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`badge ${s.status==="assigned"?"badge-success":s.status==="maintenance"?"badge-warning":"badge-gray"}`,children:s.status==="assigned"?"מוקצה":s.status==="maintenance"?"בתחזוקה":"במחסן"}),s.license_expiry&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["רישיון: ",s.license_expiry]})]})]})},s.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"אין נשק מוקצה"})]}),o==="equipment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold font-heading",children:"ציוד מוקצה"}),((H=T==null?void 0:T.equipment)==null?void 0:H.length)>0?e.jsx("div",{className:"space-y-2",children:T.equipment.map(s=>{const S={new:"חדש",good:"תקין",fair:"סביר",needs_repair:"דורש תיקון",damaged:"פגום"};return e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(re,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.item_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.item_type,s.serial_number&&` | מס"ס: ${s.serial_number}`]}),s.assigned_date&&e.jsxs("p",{className:"text-xs text-gray-400",children:["מאז: ",s.assigned_date]})]})]}),e.jsx("span",{className:`badge ${s.condition==="good"||s.condition==="new"?"badge-success":s.condition==="fair"?"badge-warning":"badge-danger"}`,children:S[s.condition]||s.condition})]})},s.id)})}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"אין ציוד מוקצה"})]}),o==="performance"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold font-heading",children:"ביצועים"}),e.jsxs("button",{onClick:()=>w(!0),className:"btn-primary text-sm flex items-center gap-1",children:[e.jsx(E,{className:"w-4 h-4"}),"דרג מאבטח"]})]}),h&&(()=>{var X,Z,ee,se,ae,te;const s=((X=h.ratings)==null?void 0:X.avg_rating)||0,S=((Z=h.ratings)==null?void 0:Z.total_ratings)||0,O=((ee=h.attendance)==null?void 0:ee.rate)||0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:[1,2,3,4,5].map(j=>e.jsx(E,{className:`w-4 h-4 ${j<=Math.round(s)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},j))}),e.jsx("p",{className:"text-2xl font-bold font-heading",children:Number(s).toFixed(1)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["דירוג ממוצע (",S," דירוגים)"]})]}),e.jsxs("div",{className:"card text-center",children:[e.jsxs("p",{className:"text-2xl font-bold font-heading text-green-600",children:[O,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"נוכחות"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("p",{className:"text-2xl font-bold font-heading text-blue-600",children:h.total_hours||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"שעות (3 חודשים)"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("p",{className:"text-2xl font-bold font-heading text-purple-600",children:h.shifts_this_month||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"משמרות החודש"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-medium mb-2 font-heading",children:"סטטיסטיקות"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-gray-500",children:"אירועי אבטחה דווחו"}),e.jsx("dd",{className:"font-medium",children:h.incidents_reported||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-gray-500",children:"סיורים שהושלמו"}),e.jsx("dd",{className:"font-medium",children:h.total_patrols||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-gray-500",children:"משמרות הגיע"}),e.jsxs("dd",{className:"font-medium",children:[((se=h.attendance)==null?void 0:se.checked_in)||0,"/",((ae=h.attendance)==null?void 0:ae.total_assignments)||0]})]})]})]}),((te=h.recent_ratings)==null?void 0:te.length)>0&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-medium mb-2 font-heading",children:"דירוגים אחרונים"}),e.jsx("div",{className:"space-y-2",children:h.recent_ratings.slice(0,5).map(j=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(ne=>e.jsx(E,{className:`w-3 h-3 ${ne<=j.rating?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},ne)),e.jsx("span",{className:"text-xs text-gray-500 mr-2",children:j.rating_type==="manager_review"?"מנהל":j.rating_type==="customer_feedback"?"לקוח":"אירוע"})]}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(j.created_at).toLocaleDateString("he-IL")})]},j.id))})]})]})]})})()]}),G&&a&&e.jsx(Le,{employeeId:t,employeeName:`${a.first_name} ${a.last_name}`,onClose:()=>w(!1)}),o==="info"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פרטי קשר"}),g?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון"}),e.jsx("input",{value:n.phone,onChange:s=>i({...n,phone:s.target.value}),className:"input",dir:"ltr",placeholder:"050-0000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"אימייל"}),e.jsx("input",{value:n.email,onChange:s=>i({...n,email:s.target.value}),className:"input",dir:"ltr",type:"email",placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"כתובת"}),e.jsx("input",{value:n.address,onChange:s=>i({...n,address:s.target.value}),className:"input",placeholder:"רחוב ומספר"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"עיר"}),e.jsx("input",{value:n.city,onChange:s=>i({...n,city:s.target.value}),className:"input",placeholder:"עיר"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Me,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"טלפון"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:`tel:${a==null?void 0:a.phone}`,className:"text-primary-600 font-medium",children:a==null?void 0:a.phone}),(a==null?void 0:a.phone)&&e.jsx(Se,{phone:a.phone,name:`${a.first_name||""} ${a.last_name||""}`.trim()||"עובד",size:"sm"})]})]})]}),(a==null?void 0:a.email)&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"אימייל"}),e.jsx("a",{href:`mailto:${a.email}`,className:"text-primary-600 font-medium",children:a.email})]})]}),(a==null?void 0:a.address)&&e.jsxs("div",{className:"flex items-center gap-3 col-span-2",children:[e.jsx(De,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"כתובת"}),e.jsxs("p",{className:"font-medium",children:[a.address,", ",a.city]})]})]})]})]}),g&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פרטי העסקה - עריכה"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג העסקה"}),e.jsx("select",{value:n.employment_type,onChange:s=>i({...n,employment_type:s.target.value}),className:"input",children:Oe.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שכר שעתי (₪)"}),e.jsx("input",{type:"number",value:n.hourly_rate,onChange:s=>i({...n,hourly_rate:s.target.value}),className:"input",dir:"ltr",placeholder:"0"})]}),e.jsxs("div",{className:"col-span-2 flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.has_weapon_license,onChange:s=>i({...n,has_weapon_license:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("span",{children:"רישיון נשק"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.has_driving_license,onChange:s=>i({...n,has_driving_license:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("span",{children:"רישיון נהיגה"})]}),n.has_driving_license&&e.jsxs("select",{value:n.driving_license_type,onChange:s=>i({...n,driving_license_type:s.target.value}),className:"input w-auto",children:[e.jsx("option",{value:"",children:"סוג רישיון"}),Be.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]})]})]}),g&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"איש קשר לחירום - עריכה"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם איש קשר"}),e.jsx("input",{value:n.emergency_contact_name,onChange:s=>i({...n,emergency_contact_name:s.target.value}),className:"input",placeholder:"שם מלא"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון חירום"}),e.jsx("input",{value:n.emergency_contact_phone,onChange:s=>i({...n,emergency_contact_phone:s.target.value}),className:"input",dir:"ltr",placeholder:"050-0000000"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"משמרות אחרונות"}),((J=u==null?void 0:u.recentShifts)==null?void 0:J.length)>0?e.jsx("div",{className:"space-y-2",children:u.recentShifts.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.company_name," - ",s.site_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.date," | ",s.start_time," - ",s.end_time]})]}),s.actual_hours&&e.jsxs("span",{className:"text-sm text-gray-500",children:[s.actual_hours," שעות"]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"אין משמרות"})]}),t&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"מסמכים"}),e.jsx(ke,{entityType:"employee",entityId:t})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פרטי העסקה"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"ת.ז"}),e.jsx("dd",{className:"font-medium",children:a==null?void 0:a.id_number})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"תאריך התחלה"}),e.jsx("dd",{className:"font-medium",children:a==null?void 0:a.hire_date})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"סוג העסקה"}),e.jsx("dd",{className:"font-medium",children:(a==null?void 0:a.employment_type)==="hourly"?"שעתי":(a==null?void 0:a.employment_type)==="monthly"?"חודשי":"קבלן"})]}),(a==null?void 0:a.hourly_rate)&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"שכר שעתי"}),e.jsxs("dd",{className:"font-medium",children:["₪",a.hourly_rate]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold font-heading",children:"מסמכים"}),e.jsxs("button",{onClick:()=>b(!N),className:"btn-primary text-sm flex items-center gap-1 px-3 py-1.5",children:[N?e.jsx(D,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"}),N?"ביטול":"הוסף מסמך"]})]}),N&&e.jsxs("form",{onSubmit:je,className:"mb-4 p-4 bg-blue-50 rounded-lg space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סוג מסמך *"}),e.jsx("select",{value:l.document_type,onChange:s=>C({...l,document_type:s.target.value}),className:"input",required:!0,children:Ie.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך תפוגה"}),e.jsx("input",{type:"date",value:l.expiry_date,onChange:s=>C({...l,expiry_date:s.target.value}),className:"input"})]}),e.jsx("button",{type:"submit",disabled:Q.isPending||!l.document_type,className:"btn-primary text-sm",children:Q.isPending?"שומר...":"שמור מסמך"})]}),((V=u==null?void 0:u.documents)==null?void 0:V.length)>0?e.jsx("div",{className:"space-y-2",children:u.documents.map(s=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:Qe[s.document_type]||s.document_type})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.expiry_date&&e.jsx("span",{className:"text-gray-500",children:s.expiry_date}),e.jsx("button",{onClick:()=>{confirm("למחוק מסמך זה?")&&ue.mutate(s.id)},className:"text-red-400 hover:text-red-600 p-1",title:"מחק מסמך",children:e.jsx(Y,{className:"w-3.5 h-3.5"})})]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-sm text-center",children:"אין מסמכים"})]}),!g&&(a==null?void 0:a.emergency_contact_name)&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"איש קשר לחירום"}),e.jsx("p",{className:"font-medium",children:a.emergency_contact_name}),e.jsx("a",{href:`tel:${a.emergency_contact_phone}`,className:"text-primary-600 text-sm",children:a.emergency_contact_phone})]})]})]})]})}export{ls as default};
