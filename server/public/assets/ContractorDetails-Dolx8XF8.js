import{D as Z,u as ee,c as se,m as ae,r as x,e as M,d as v,j as e,al as D,B as te,X as R,U as W,S as le,t as q,z as d,am as p}from"./index-DNhSfFTF.js";import{A as re,S as ne}from"./save-DJuc85Nt.js";import{P as T}from"./pen-line-CTwFjm8c.js";import{M as A}from"./map-pin-CnrXv9DV.js";import{P as K}from"./phone-C6GpoGt1.js";import{M as ie}from"./mail-elckFBEn.js";import{P as ce}from"./plus-42YS-w1A.js";import{T as de}from"./trash-2-C8JFUyr_.js";import{D as me}from"./dollar-sign-dd770Rbk.js";import{S as I}from"./star-Bi8HfDq8.js";const Q=[{value:"active",label:"פעיל"},{value:"inactive",label:"לא פעיל"},{value:"blacklisted",label:"חסום"}],xe=[{key:"details",label:"פרטים"},{key:"workers",label:"עובדים"},{key:"events",label:"אירועים"},{key:"financials",label:"כספים"}];function oe({value:r,onChange:o}){return e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(m=>e.jsx("button",{type:"button",onClick:()=>o(m===r?0:m),className:"p-0.5",children:e.jsx(I,{className:`w-5 h-5 transition-colors ${m<=r?"text-yellow-400 fill-yellow-400":"text-gray-300 hover:text-yellow-300"}`})},m))})}function he({rating:r}){return e.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(o=>e.jsx(I,{className:`w-4 h-4 ${o<=r?"text-yellow-400 fill-yellow-400":"text-gray-200"}`},o))})}function we(){var L;const{id:r}=Z(),o=ee(),m=se(),{can:g}=ae(),[h,B]=x.useState("details"),[j,f]=x.useState(!1),[N,_]=x.useState(!1),[w,y]=x.useState(null),[z,k]=x.useState(0),[t,n]=x.useState({company_name:"",contact_name:"",phone:"",email:"",specialization:"",hourly_rate:"",daily_rate:"",max_workers:"",status:"active",notes:"",address:"",city:"",business_id:""}),[l,i]=x.useState({name:"",phone:"",id_number:"",has_weapon_license:!1}),{data:u,isLoading:U}=M({queryKey:["contractor",r],queryFn:()=>p.getOne(r).then(s=>s.data),enabled:!!r}),{data:C}=M({queryKey:["contractor-events",r],queryFn:()=>p.getEvents(r).then(s=>s.data),enabled:!!r&&(h==="events"||h==="financials")}),a=u==null?void 0:u.contractor,b=(u==null?void 0:u.workers)||[],c=(C==null?void 0:C.events)||[];x.useEffect(()=>{a&&(n({company_name:a.company_name||"",contact_name:a.contact_name||"",phone:a.phone||"",email:a.email||"",specialization:a.specialization||"",hourly_rate:a.hourly_rate||"",daily_rate:a.daily_rate||"",max_workers:a.max_workers||"",status:a.status||"active",notes:a.notes||"",address:a.address||"",city:a.city||"",business_id:a.business_id||""}),k(a.rating||0))},[a]);const S=v({mutationFn:s=>p.update(r,s),onSuccess:()=>{m.invalidateQueries({queryKey:["contractor",r]}),m.invalidateQueries({queryKey:["contractors"]}),d.success("הקבלן עודכן בהצלחה"),f(!1)},onError:()=>d.error("שגיאה בעדכון הקבלן")}),P=v({mutationFn:s=>p.addWorker(r,s),onSuccess:()=>{m.invalidateQueries({queryKey:["contractor",r]}),d.success("עובד נוסף בהצלחה"),_(!1),i({name:"",phone:"",id_number:"",has_weapon_license:!1})},onError:()=>d.error("שגיאה בהוספת עובד")}),E=v({mutationFn:({workerId:s,workerData:F})=>p.updateWorker(r,s,F),onSuccess:()=>{m.invalidateQueries({queryKey:["contractor",r]}),d.success("עובד עודכן בהצלחה"),y(null),i({name:"",phone:"",id_number:"",has_weapon_license:!1})},onError:()=>d.error("שגיאה בעדכון עובד")}),O=v({mutationFn:s=>p.deleteWorker(r,s),onSuccess:()=>{m.invalidateQueries({queryKey:["contractor",r]}),d.success("עובד נמחק בהצלחה")},onError:()=>d.error("שגיאה במחיקת עובד")}),V=()=>{if(!t.company_name.trim()){d.error("שם חברה הוא שדה חובה");return}if(!t.contact_name.trim()){d.error("שם איש קשר הוא שדה חובה");return}const s={...t,hourly_rate:t.hourly_rate?Number(t.hourly_rate):null,daily_rate:t.daily_rate?Number(t.daily_rate):null,max_workers:t.max_workers?Number(t.max_workers):10,rating:z};S.mutate(s)},X=()=>{a&&(n({company_name:a.company_name||"",contact_name:a.contact_name||"",phone:a.phone||"",email:a.email||"",specialization:a.specialization||"",hourly_rate:a.hourly_rate||"",daily_rate:a.daily_rate||"",max_workers:a.max_workers||"",status:a.status||"active",notes:a.notes||"",address:a.address||"",city:a.city||"",business_id:a.business_id||""}),k(a.rating||0)),f(!1)},G=s=>{if(s.preventDefault(),!l.name.trim()){d.error("נדרש שם עובד");return}P.mutate(l)},H=s=>{s.preventDefault(),!(!w||!l.name.trim())&&E.mutate({workerId:w,workerData:l})},J=s=>{y(s.id),i({name:s.name||"",phone:s.phone||"",id_number:s.id_number||"",has_weapon_license:s.has_weapon_license||!1}),_(!1)},$=x.useMemo(()=>{if(!c||c.length===0)return{totalRevenue:0,averagePerEvent:0,eventCount:0};const s=c.reduce((F,Y)=>F+(Y.cost||0),0);return{totalRevenue:s,averagePerEvent:c.length>0?s/c.length:0,eventCount:c.length}},[c]);return U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary-600 border-t-transparent"})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>o("/contractors"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(re,{className:"w-5 h-5"}),"חזרה לקבלנים"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-primary-100 to-primary-50 rounded-xl flex items-center justify-center",children:e.jsx(te,{className:"w-8 h-8 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 font-heading",children:a.company_name}),e.jsx("p",{className:"text-gray-500",children:a.contact_name}),a.rating>0&&e.jsx("div",{className:"mt-1",children:e.jsx(he,{rating:a.rating})})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:V,disabled:S.isPending,className:"btn-success text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(ne,{className:"w-4 h-4"}),S.isPending?"שומר...":"שמור"]}),e.jsxs("button",{onClick:X,className:"btn-secondary text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(R,{className:"w-4 h-4"}),"ביטול"]})]}):g("contractors:edit")&&e.jsxs("button",{onClick:()=>f(!0),className:"btn-primary text-sm flex items-center gap-1 px-3 py-2",children:[e.jsx(T,{className:"w-4 h-4"}),"עריכה"]})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex gap-6 -mb-px",children:xe.map(s=>e.jsx("button",{onClick:()=>B(s.key),className:`pb-3 px-1 text-sm font-medium border-b-2 transition-colors ${h===s.key?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:s.label},s.key))})}),h==="details"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פרטי חברה"}),j?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם חברה *"}),e.jsx("input",{value:t.company_name,onChange:s=>n({...t,company_name:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ח.פ / ע.מ"}),e.jsx("input",{value:t.business_id,onChange:s=>n({...t,business_id:s.target.value}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"כתובת"}),e.jsx("input",{value:t.address,onChange:s=>n({...t,address:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"עיר"}),e.jsx("input",{value:t.city,onChange:s=>n({...t,city:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תחום התמחות"}),e.jsx("input",{value:t.specialization,onChange:s=>n({...t,specialization:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סטטוס"}),e.jsx("select",{value:t.status,onChange:s=>n({...t,status:s.target.value}),className:"input",children:Q.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"col-span-1 sm:col-span-2",children:[e.jsx("label",{className:"label",children:"דירוג"}),e.jsx(oe,{value:z,onChange:k})]}),e.jsxs("div",{className:"col-span-1 sm:col-span-2",children:[e.jsx("label",{className:"label",children:"הערות"}),e.jsx("textarea",{value:t.notes,onChange:s=>n({...t,notes:s.target.value}),className:"input",rows:3})]})]}):e.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"שם חברה"}),e.jsx("dd",{className:"font-medium",children:a.company_name})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"ח.פ / ע.מ"}),e.jsx("dd",{className:"font-medium",children:a.business_id||"-"})]}),a.address&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"כתובת"}),e.jsxs("dd",{className:"font-medium flex items-center gap-1",children:[e.jsx(A,{className:"w-3.5 h-3.5 text-gray-400"}),a.address,a.city?`, ${a.city}`:""]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"תחום התמחות"}),e.jsx("dd",{className:"font-medium",children:a.specialization||"-"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"סטטוס"}),e.jsx("dd",{children:e.jsx("span",{className:`badge ${a.status==="active"?"badge-success":a.status==="blacklisted"?"badge-danger":"badge-gray"}`,children:((L=Q.find(s=>s.value===a.status))==null?void 0:L.label)||a.status})})]}),a.notes&&e.jsxs("div",{className:"col-span-1 sm:col-span-2",children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"הערות"}),e.jsx("dd",{className:"font-medium text-sm whitespace-pre-wrap",children:a.notes})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פרטי קשר"}),j?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"איש קשר *"}),e.jsx("input",{value:t.contact_name,onChange:s=>n({...t,contact_name:s.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון"}),e.jsx("input",{value:t.phone,onChange:s=>n({...t,phone:s.target.value}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"אימייל"}),e.jsx("input",{value:t.email,onChange:s=>n({...t,email:s.target.value}),className:"input",dir:"ltr",type:"email"})]})]}):e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"איש קשר"}),e.jsx("dd",{className:"font-medium",children:a.contact_name})]}),a.phone&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"טלפון"}),e.jsxs("dd",{className:"font-medium flex items-center gap-1.5",children:[e.jsx(K,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx("a",{href:`tel:${a.phone}`,className:"text-primary-600",dir:"ltr",children:a.phone})]})]}),a.email&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"אימייל"}),e.jsxs("dd",{className:"font-medium flex items-center gap-1.5",children:[e.jsx(ie,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx("a",{href:`mailto:${a.email}`,className:"text-primary-600",dir:"ltr",children:a.email})]})]})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פרטים כספיים"}),j?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תעריף שעתי (₪)"}),e.jsx("input",{value:t.hourly_rate,onChange:s=>n({...t,hourly_rate:s.target.value}),className:"input",type:"number",step:"0.01",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תעריף יומי (₪)"}),e.jsx("input",{value:t.daily_rate,onChange:s=>n({...t,daily_rate:s.target.value}),className:"input",type:"number",step:"0.01",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"מקסימום עובדים"}),e.jsx("input",{value:t.max_workers,onChange:s=>n({...t,max_workers:s.target.value}),className:"input",type:"number",dir:"ltr"})]})]}):e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"תעריף שעתי"}),e.jsx("dd",{className:"font-medium",children:a.hourly_rate?`₪${a.hourly_rate.toLocaleString()}`:"-"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"תעריף יומי"}),e.jsx("dd",{className:"font-medium",children:a.daily_rate?`₪${a.daily_rate.toLocaleString()}`:"-"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"מקסימום עובדים"}),e.jsx("dd",{className:"font-medium",children:a.max_workers||10})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500",children:"עובדים רשומים"}),e.jsxs("dd",{className:"font-medium flex items-center gap-1.5",children:[e.jsx(W,{className:"w-3.5 h-3.5 text-gray-400"}),a.workers_count||b.length||0]})]})]})]})})]}),h==="workers"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold font-heading",children:"עובדי קבלן"}),g("contractors:edit")&&e.jsxs("button",{onClick:()=>{_(!N),y(null),i({name:"",phone:"",id_number:"",has_weapon_license:!1})},className:"btn-primary text-sm flex items-center gap-1 px-3 py-1.5",children:[N?e.jsx(R,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"}),N?"ביטול":"הוסף עובד"]})]}),N&&e.jsxs("form",{onSubmit:G,className:"mb-4 p-4 bg-blue-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם *"}),e.jsx("input",{value:l.name,onChange:s=>i({...l,name:s.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון"}),e.jsx("input",{value:l.phone,onChange:s=>i({...l,phone:s.target.value}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ת.ז"}),e.jsx("input",{value:l.id_number,onChange:s=>i({...l,id_number:s.target.value}),className:"input",dir:"ltr"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer pb-2.5",children:[e.jsx("input",{type:"checkbox",checked:l.has_weapon_license,onChange:s=>i({...l,has_weapon_license:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-700",children:"רישיון נשק"})]})})]}),e.jsx("button",{type:"submit",disabled:P.isPending||!l.name.trim(),className:"btn-primary text-sm",children:P.isPending?"שומר...":"שמור עובד"})]}),w&&e.jsxs("form",{onSubmit:H,className:"mb-4 p-4 bg-yellow-50 rounded-lg space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"עריכת עובד"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם *"}),e.jsx("input",{value:l.name,onChange:s=>i({...l,name:s.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"טלפון"}),e.jsx("input",{value:l.phone,onChange:s=>i({...l,phone:s.target.value}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ת.ז"}),e.jsx("input",{value:l.id_number,onChange:s=>i({...l,id_number:s.target.value}),className:"input",dir:"ltr"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer pb-2.5",children:[e.jsx("input",{type:"checkbox",checked:l.has_weapon_license,onChange:s=>i({...l,has_weapon_license:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-700",children:"רישיון נשק"})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:E.isPending||!l.name.trim(),className:"btn-primary text-sm",children:E.isPending?"שומר...":"עדכן עובד"}),e.jsx("button",{type:"button",onClick:()=>{y(null),i({name:"",phone:"",id_number:"",has_weapon_license:!1})},className:"btn-secondary text-sm",children:"ביטול"})]})]}),b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"שם"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"טלפון"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"ת.ז"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"רישיון נשק"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"סטטוס"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"פעולות"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:b.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:s.name}),e.jsx("td",{className:"py-3 px-4",dir:"ltr",children:s.phone?e.jsxs("a",{href:`tel:${s.phone}`,className:"text-primary-600 flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),s.phone]}):"-"}),e.jsx("td",{className:"py-3 px-4",dir:"ltr",children:s.id_number||"-"}),e.jsx("td",{className:"py-3 px-4",children:s.has_weapon_license?e.jsxs("span",{className:"badge badge-info flex items-center gap-1 w-fit",children:[e.jsx(le,{className:"w-3 h-3"}),"יש"]}):e.jsx("span",{className:"text-gray-400",children:"אין"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`badge ${s.status==="active"?"badge-success":"badge-gray"}`,children:s.status==="active"?"פעיל":"לא פעיל"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[g("contractors:edit")&&e.jsx("button",{onClick:()=>J(s),className:"p-1.5 rounded-lg text-gray-400 hover:text-primary-600 hover:bg-primary-50 transition-colors",title:"ערוך",children:e.jsx(T,{className:"w-3.5 h-3.5"})}),g("contractors:delete")&&e.jsx("button",{onClick:()=>{confirm("האם אתה בטוח שברצונך למחוק עובד זה?")&&O.mutate(s.id)},className:"p-1.5 rounded-lg text-gray-400 hover:text-danger-500 hover:bg-danger-50 transition-colors",title:"מחק",children:e.jsx(de,{className:"w-3.5 h-3.5"})})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"אין עובדים רשומים לקבלן זה"})]})]})}),h==="events"&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"אירועים"}),c.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"שם אירוע"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"תאריך"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"מיקום"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"עובדים"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"עלות"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-500",children:"סטטוס"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:c.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("a",{href:`/events/${s.id}`,className:"font-medium text-primary-600 hover:text-primary-700",children:s.event_name})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(q,{className:"w-3.5 h-3.5 text-gray-400"}),s.event_date]})}),e.jsx("td",{className:"py-3 px-4",children:s.location?e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(A,{className:"w-3.5 h-3.5 text-gray-400"}),s.location]}):"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(W,{className:"w-3.5 h-3.5 text-gray-400"}),s.workers_count||0]})}),e.jsx("td",{className:"py-3 px-4 font-medium",children:s.cost?`₪${s.cost.toLocaleString()}`:"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`badge ${s.status==="completed"?"badge-success":s.status==="active"?"badge-info":s.status==="cancelled"?"badge-danger":"badge-gray"}`,children:s.status==="completed"?"הושלם":s.status==="active"?"פעיל":s.status==="cancelled"?"בוטל":s.status==="scheduled"?"מתוכנן":s.status})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"אין אירועים לקבלן זה"})]})]}),h==="financials"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center",children:e.jsx(me,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:'סה"כ הכנסות מאירועים'}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["₪",$.totalRevenue.toLocaleString()]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center",children:e.jsx(D,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"ממוצע לאירוע"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["₪",$.averagePerEvent.toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"מספר אירועים"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:$.eventCount})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"תעריפים"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"תעריף שעתי"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 mt-1",children:a.hourly_rate?`₪${a.hourly_rate.toLocaleString()}`:"-"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"תעריף יומי"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 mt-1",children:a.daily_rate?`₪${a.daily_rate.toLocaleString()}`:"-"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"עובדים פעילים"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 mt-1",children:[a.workers_count||b.length||0," / ",a.max_workers||10]})]})]})]}),c.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 font-heading",children:"פירוט אירועים"}),e.jsx("div",{className:"space-y-2",children:c.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.event_name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.event_date})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-sm",children:s.cost?`₪${s.cost.toLocaleString()}`:"-"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.workers_count||0," עובדים"]})]})]},s.id))})]})]})]}):e.jsxs("div",{className:"card text-center py-16",children:[e.jsx(D,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"הקבלן לא נמצא"}),e.jsx("button",{onClick:()=>o("/contractors"),className:"btn-primary mt-4",children:"חזרה לקבלנים"})]})}export{we as default};
