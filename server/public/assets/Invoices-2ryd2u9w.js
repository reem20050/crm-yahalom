import{x as Se,r as c,c as ke,m as _e,e as T,d as m,j as e,w as Ce,B as Ie,n as Pe,X as M,z as t,i as u,H as ie,h as qe}from"./index-DNhSfFTF.js";import{u as Me}from"./index.esm-CTjlG80w.js";import{t as De,o as Ee,s as w,c as Fe}from"./types-C-QvhzS9.js";import{S as G,c as Ke}from"./Skeleton-B57jvd7z.js";import{P as Qe,D as Ae,e as Le}from"./pdfExport-BmWS57uU.js";import{u as Oe,B as Te}from"./BulkActionBar-DykjjnnX.js";import{R as Ge}from"./refresh-cw-JBVqlPPd.js";import{P as R}from"./plus-42YS-w1A.js";import{E as Re}from"./external-link-BplGfNjn.js";import{M as re}from"./mail-elckFBEn.js";import{T as B}from"./trash-2-C8JFUyr_.js";import{A as Be}from"./alert-circle-DKePiqWg.js";import{C as ce}from"./check-CKd6TXeu.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=Se("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),S={draft:{label:"טיוטה",class:"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700",dot:"bg-gray-400"},sent:{label:"נשלחה",class:"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-50 text-primary-700",dot:"bg-primary-500"},paid:{label:"שולמה",class:"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-50 text-success-700",dot:"bg-success-500"},overdue:{label:"באיחור",class:"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-danger-50 text-danger-700",dot:"bg-danger-500"},cancelled:{label:"בוטלה",class:"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-500",dot:"bg-gray-400"}},$e=Ee({customer_id:w().min(1,"נדרש לבחור לקוח"),invoice_number:w().optional(),issue_date:w().min(1,"נדרש תאריך הפקה"),due_date:w().min(1,"נדרש תאריך תשלום"),total_amount:Fe.number().min(.01,"סכום חייב להיות גדול מ-0"),description:w().optional()});function ns(){var ae,te,ne;const[D,oe]=c.useState(""),[me,v]=c.useState(!1),[$,k]=c.useState({invoiceId:"",show:!1}),[z,H]=c.useState(new Date().toISOString().split("T")[0]),[ue,_]=c.useState(!1),[d,x]=c.useState([{description:"",quantity:1,unitPrice:0}]),[E,V]=c.useState(""),[X,xe]=c.useState(new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]),[J,U]=c.useState(""),[W,C]=c.useState({invoiceId:"",show:!1}),[I,P]=c.useState(""),l=ke(),{can:p}=_e(),{selectedIds:Y,selectedCount:F,isSelected:Z,toggleSelect:pe,toggleAll:he,clearSelection:K}=Oe(),{data:h,isLoading:je}=T({queryKey:["invoices",{status:D}],queryFn:()=>u.getAll({status:D,limit:50}).then(s=>s.data)}),{data:r}=T({queryKey:["invoices-summary"],queryFn:()=>u.getMonthlySummary().then(s=>s.data)}),{data:j}=T({queryKey:["customers-list"],queryFn:()=>qe.getAll({limit:200}).then(s=>s.data)}),Q=m({mutationFn:s=>u.create(s),onSuccess:()=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]}),t.success("חשבונית נוצרה בהצלחה"),v(!1),O()},onError:()=>{t.error("שגיאה ביצירת חשבונית")}}),q=m({mutationFn:({id:s,status:a,paymentDate:i})=>u.updateStatus(s,a,i),onSuccess:()=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]}),t.success("סטטוס עודכן בהצלחה"),k({invoiceId:"",show:!1})},onError:()=>{t.error("שגיאה בעדכון סטטוס")}}),ge=m({mutationFn:s=>u.delete(s),onSuccess:()=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]}),t.success("חשבונית נמחקה בהצלחה")},onError:()=>{t.error("שגיאה במחיקת חשבונית")}}),A=m({mutationFn:s=>ie.createGreenInvoice(s),onSuccess:()=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]}),t.success("חשבונית ירוקה נוצרה בהצלחה"),_(!1),x([{description:"",quantity:1,unitPrice:0}]),V(""),U("")},onError:()=>t.error("שגיאה ביצירת חשבונית ירוקה")}),L=m({mutationFn:()=>ie.syncGreenInvoices(),onSuccess:s=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]});const a=s.data.count||0;t.success(a>0?`סונכרנו ${a} חשבוניות מחשבונית ירוקה`:"אין חשבוניות חדשות לסנכרון")},onError:()=>t.error("שגיאה בסנכרון חשבוניות")}),g=m({mutationFn:({id:s,email:a})=>u.sendEmail(s,a),onSuccess:s=>{l.invalidateQueries({queryKey:["invoices"]}),t.success(s.data.message||"חשבונית נשלחה במייל"),C({invoiceId:"",show:!1}),P("")},onError:s=>{var n,N,f;const i=((N=(n=s.response)==null?void 0:n.data)==null?void 0:N.error)||"שגיאה בשליחת חשבונית במייל";i.includes("לא נמצא אימייל")?(C({invoiceId:((f=g.variables)==null?void 0:f.id)||"",show:!0}),t.error("לא נמצא אימייל ללקוח - הזן אימייל ידנית")):t.error(i)}}),ee=m({mutationFn:s=>u.bulkApprove(s),onSuccess:s=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]}),K(),t.success(s.data.message||"חשבוניות אושרו")},onError:()=>t.error("שגיאה באישור חשבוניות")}),se=m({mutationFn:s=>u.bulkDelete(s),onSuccess:s=>{l.invalidateQueries({queryKey:["invoices"]}),l.invalidateQueries({queryKey:["invoices-summary"]}),K(),t.success(s.data.message||"חשבוניות נמחקו")},onError:()=>t.error("שגיאה במחיקת חשבוניות")}),{register:b,handleSubmit:be,reset:O,formState:{errors:o}}=Me({resolver:De($e),defaultValues:{issue_date:new Date().toISOString().split("T")[0]}}),ye=s=>{Q.mutate(s)},ve=(s,a)=>{if(a==="paid"){k({invoiceId:s,show:!0}),H(new Date().toISOString().split("T")[0]);return}q.mutate({id:s,status:a})},Ne=()=>{q.mutate({id:$.invoiceId,status:"paid",paymentDate:z})},fe=s=>s.computed_status||s.status,we=()=>{if(!E){t.error("נדרש לבחור לקוח");return}const s=d.filter(a=>a.description&&a.unitPrice>0);if(s.length===0){t.error("נדרשת לפחות שורה אחת");return}A.mutate({customerId:E,items:s.map(a=>({description:a.description,quantity:a.quantity,unitPrice:a.unitPrice})),dueDate:X,remarks:J})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"חשבוניות"}),e.jsx("p",{className:"page-subtitle",children:"ניהול חשבוניות ותשלומים"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p("invoices:create")&&e.jsxs("button",{onClick:()=>L.mutate(),disabled:L.isPending,className:"btn-secondary flex items-center gap-2",children:[e.jsx(Ge,{className:`w-5 h-5 ${L.isPending?"animate-spin":""}`}),"סנכרן"]}),p("invoices:create")&&e.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors font-medium",children:[e.jsx(de,{className:"w-5 h-5"}),"חשבונית ירוקה"]}),e.jsxs("button",{onClick:()=>window.print(),className:"btn-secondary flex items-center gap-2 no-print",children:[e.jsx(Qe,{className:"w-5 h-5"}),"הדפס"]}),p("invoices:create")&&e.jsxs("button",{onClick:()=>v(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5"}),"חשבונית חדשה"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"stat-card",children:[e.jsxs("p",{className:"stat-card-value font-heading",children:["₪",((r==null?void 0:r.total_amount)||0).toLocaleString()]}),e.jsx("p",{className:"stat-card-label",children:'סה"כ החודש'})]}),e.jsxs("div",{className:"stat-card",children:[e.jsxs("p",{className:"stat-card-value font-heading text-success-600",children:["₪",((r==null?void 0:r.paid_amount)||0).toLocaleString()]}),e.jsx("p",{className:"stat-card-label",children:"שולם"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsxs("p",{className:"stat-card-value font-heading text-warning-600",children:["₪",((r==null?void 0:r.pending_amount)||0).toLocaleString()]}),e.jsx("p",{className:"stat-card-label",children:"ממתין לתשלום"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("p",{className:"stat-card-value font-heading",children:(r==null?void 0:r.total_invoices)||0}),e.jsx("p",{className:"stat-card-label",children:"חשבוניות"})]})]}),e.jsx("div",{className:"card !p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ce,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:"חיפוש חשבונית...",className:"input pr-11 w-full",readOnly:!1})]}),e.jsxs("select",{value:D,onChange:s=>oe(s.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"כל הסטטוסים"}),Object.entries(S).map(([s,{label:a}])=>e.jsx("option",{value:s,children:a},s))]})]})}),je?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{className:"h-8 w-40"}),e.jsx(G,{className:"h-4 w-56"})]}),e.jsx(G,{className:"h-10 w-36 rounded-xl"})]}),e.jsx(Ke,{columns:6,rows:5})]}):((ae=h==null?void 0:h.invoices)==null?void 0:ae.length)>0?e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:e.jsx("input",{type:"checkbox",checked:F>0&&F===h.invoices.length,onChange:()=>he(h.invoices.map(s=>s.id)),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer"})}),e.jsx("th",{children:"מספר חשבונית"}),e.jsx("th",{children:"לקוח"}),e.jsx("th",{children:"מקור"}),e.jsx("th",{children:"תאריך הפקה"}),e.jsx("th",{children:"תאריך תשלום"}),e.jsx("th",{children:"סכום"}),e.jsx("th",{children:"סטטוס"}),e.jsx("th",{children:"פעולות"})]})}),e.jsx("tbody",{children:h.invoices.map(s=>{var n,N,f,le;const a=fe(s),i=a==="overdue";return e.jsxs("tr",{className:`border-b border-gray-50 last:border-0 ${Z(s.id)?"bg-primary-50":""} ${i?"ring-1 ring-danger-200/50 bg-danger-50/30":""}`,children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:Z(s.id),onChange:()=>pe(s.id),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer"})}),e.jsxs("td",{className:"font-medium font-heading",children:["#",s.invoice_number||s.id.slice(0,8)]}),e.jsx("td",{children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-gray-400"}),s.company_name]})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.green_invoice_id?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700 border border-green-200",children:[e.jsx(de,{className:"w-3 h-3"}),"חשבונית ירוקה"]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600 border border-gray-200",children:"ידני"}),s.document_url&&e.jsx("a",{href:s.document_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",title:"צפה במסמך",children:e.jsx(Re,{className:"w-3.5 h-3.5"})})]})}),e.jsx("td",{children:s.issue_date}),e.jsx("td",{children:e.jsxs("span",{className:"flex items-center gap-1",children:[s.due_date,s.days_overdue>0&&e.jsxs("span",{className:"text-danger-600 text-xs font-medium",children:["(",s.days_overdue," ימים)"]})]})}),e.jsxs("td",{className:"font-medium font-heading",children:["₪",(n=s.total_amount)==null?void 0:n.toLocaleString()]}),e.jsx("td",{children:e.jsxs("span",{className:((N=S[a])==null?void 0:N.class)||"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${((f=S[a])==null?void 0:f.dot)||"bg-gray-400"}`}),((le=S[a])==null?void 0:le.label)||s.status]})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[p("invoices:status")&&a!=="paid"&&a!=="cancelled"&&e.jsxs("select",{className:"input py-1 px-2 text-sm w-auto",value:"",onChange:y=>{y.target.value&&(ve(s.id,y.target.value),y.target.value="")},children:[e.jsx("option",{value:"",children:"שנה סטטוס"}),a!=="sent"&&e.jsx("option",{value:"sent",children:"נשלחה"}),e.jsx("option",{value:"paid",children:"שולמה"}),e.jsx("option",{value:"cancelled",children:"בוטלה"})]}),e.jsx("button",{onClick:()=>{var y;return Le({invoice_number:s.invoice_number,company_name:s.company_name,issue_date:s.issue_date,due_date:s.due_date,total_amount:s.total_amount,status:((y=S[a])==null?void 0:y.label)||a,description:s.description})},className:"text-gray-400 hover:text-gray-600 p-1",title:"הורד PDF",children:e.jsx(Ae,{className:"w-4 h-4"})}),p("invoices:create")&&a!=="cancelled"&&e.jsx("button",{onClick:()=>g.mutate({id:s.id}),disabled:g.isPending,className:"text-blue-400 hover:text-blue-600 p-1",title:"שלח חשבונית במייל",children:e.jsx(re,{className:"w-4 h-4"})}),p("invoices:delete")&&a==="draft"&&e.jsx("button",{onClick:()=>{confirm("האם אתה בטוח שברצונך למחוק חשבונית זו?")&&ge.mutate(s.id)},className:"text-red-400 hover:text-red-600 p-1",title:"מחק חשבונית",children:e.jsx(B,{className:"w-4 h-4"})})]})})]},s.id)})})]})}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsx(Pe,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"empty-state-title",children:"לא נמצאו חשבוניות"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"צור חשבונית ראשונה כדי להתחיל לנהל תשלומים"}),e.jsxs("button",{onClick:()=>v(!0),className:"btn-primary",children:[e.jsx(R,{className:"w-4 h-4 ml-2"}),"צור חשבונית ראשונה"]})]}),me&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"חשבונית חדשה"}),e.jsx("button",{onClick:()=>{v(!1),O()},className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:be(ye),className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"label",children:"לקוח *"}),e.jsxs("select",{...b("customer_id"),className:"input",children:[e.jsx("option",{value:"",children:"בחר לקוח..."}),(te=j==null?void 0:j.customers)==null?void 0:te.map(s=>e.jsx("option",{value:s.id,children:s.company_name},s.id))]}),o.customer_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.customer_id.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"מספר חשבונית"}),e.jsx("input",{...b("invoice_number"),className:"input",dir:"ltr",placeholder:"אוטומטי אם ריק"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"סכום *"}),e.jsx("input",{...b("total_amount"),type:"number",step:"0.01",min:"0",className:"input",dir:"ltr",placeholder:"0.00"}),o.total_amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.total_amount.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך הפקה *"}),e.jsx("input",{...b("issue_date"),type:"date",className:"input",dir:"ltr"}),o.issue_date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.issue_date.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך לתשלום *"}),e.jsx("input",{...b("due_date"),type:"date",className:"input",dir:"ltr"}),o.due_date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.due_date.message})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"label",children:"תיאור"}),e.jsx("textarea",{...b("description"),className:"input min-h-[80px]",placeholder:"פירוט שירותים..."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:Q.isPending,className:"btn-primary flex-1",children:Q.isPending?"שומר...":"צור חשבונית"}),e.jsx("button",{type:"button",onClick:()=>{v(!1),O()},className:"btn-secondary",children:"ביטול"})]})]})]})}),ue&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content w-full max-w-3xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"הפקת חשבונית ירוקה"}),e.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"לקוח *"}),e.jsxs("select",{value:E,onChange:s=>V(s.target.value),className:"input",children:[e.jsx("option",{value:"",children:"בחר לקוח..."}),(ne=j==null?void 0:j.customers)==null?void 0:ne.map(s=>e.jsx("option",{value:s.id,children:s.company_name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"פריטים"}),e.jsx("div",{className:"space-y-2",children:d.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"תיאור",value:s.description,onChange:i=>{const n=[...d];n[a].description=i.target.value,x(n)},className:"input flex-1"}),e.jsx("input",{type:"number",placeholder:"כמות",min:"1",value:s.quantity,onChange:i=>{const n=[...d];n[a].quantity=Number(i.target.value)||1,x(n)},className:"input w-20",dir:"ltr"}),e.jsx("input",{type:"number",placeholder:"מחיר יחידה",min:"0",step:"0.01",value:s.unitPrice||"",onChange:i=>{const n=[...d];n[a].unitPrice=Number(i.target.value)||0,x(n)},className:"input w-28",dir:"ltr"}),e.jsxs("span",{className:"text-sm font-medium w-24 text-left",dir:"ltr",children:["₪",(s.quantity*s.unitPrice).toLocaleString()]}),d.length>1&&e.jsx("button",{onClick:()=>{x(d.filter((i,n)=>n!==a))},className:"text-red-400 hover:text-red-600 p-1",children:e.jsx(B,{className:"w-4 h-4"})})]},a))}),e.jsxs("button",{type:"button",onClick:()=>x([...d,{description:"",quantity:1,unitPrice:0}]),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),"הוסף שורה"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-t border-b font-bold text-lg font-heading",children:[e.jsx("span",{children:'סה"כ'}),e.jsxs("span",{dir:"ltr",children:["₪",d.reduce((s,a)=>s+a.quantity*a.unitPrice,0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"תאריך לתשלום"}),e.jsx("input",{type:"date",value:X,onChange:s=>xe(s.target.value),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"הערות"}),e.jsx("textarea",{value:J,onChange:s=>U(s.target.value),className:"input min-h-[80px]",placeholder:"הערות נוספות..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:we,disabled:A.isPending,className:"btn-primary flex-1",children:A.isPending?"מפיק...":"הפק חשבונית"}),e.jsx("button",{onClick:()=>_(!1),className:"btn-secondary",children:"ביטול"})]})]})]})}),W.show&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-lg font-bold",children:"שליחת חשבונית במייל"}),e.jsx("button",{onClick:()=>{C({invoiceId:"",show:!1}),P("")},className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[e.jsx(Be,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"לא נמצא אימייל לאיש קשר של לקוח זה. הזן כתובת אימייל ידנית לשליחה."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"כתובת אימייל"}),e.jsx("input",{type:"email",value:I,onChange:s=>P(s.target.value),className:"input",dir:"ltr",placeholder:"customer@example.com"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{if(!I||!I.includes("@")){t.error("נדרשת כתובת אימייל תקינה");return}g.mutate({id:W.invoiceId,email:I})},disabled:g.isPending,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),g.isPending?"שולח...":"שלח חשבונית"]}),e.jsx("button",{onClick:()=>{C({invoiceId:"",show:!1}),P("")},className:"btn-secondary",children:"ביטול"})]})]})]})}),$.show&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-lg font-bold",children:"תאריך תשלום"}),e.jsx("button",{onClick:()=>k({invoiceId:"",show:!1}),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"בחר תאריך תשלום"}),e.jsx("input",{type:"date",value:z,onChange:s=>H(s.target.value),className:"input",dir:"ltr"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:Ne,disabled:q.isPending,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),q.isPending?"מעדכן...":"אשר תשלום"]}),e.jsx("button",{onClick:()=>k({invoiceId:"",show:!1}),className:"btn-secondary",children:"ביטול"})]})]})]})}),e.jsx(Te,{selectedCount:F,onClear:K,actions:[{label:"אשר טיוטות",onClick:()=>ee.mutate([...Y]),icon:e.jsx(ce,{className:"w-4 h-4"}),variant:"success",loading:ee.isPending},{label:"מחק נבחרים",onClick:()=>{confirm("האם למחוק את החשבוניות הנבחרות?")&&se.mutate([...Y])},icon:e.jsx(B,{className:"w-4 h-4"}),variant:"danger",loading:se.isPending}]})]})}export{ns as default};
