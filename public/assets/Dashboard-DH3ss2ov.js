import{c as fe,R as y,d as Q,r as ae,e as J,j as t,A as z,F as G,L as k,U as ve,B as be,C as je,P as Z,f as Ne,g as ee}from"./index-BGOlPzIM.js";import{S as oe}from"./shield-C9G2romd.js";import{i as _e,D as we,f as Ae,E as Pe,L as U,a as M,C as Oe,A as Se,b as F,c as ke,d as X,h as De,e as Ee,g as le,u as Le,G as Ce,j as te,k as Te,X as ce,Y as de,l as $e,T as me,R as Ie,m as Fe,n as Be}from"./generateCategoricalChart-zk8KlVya.js";import{M as re}from"./map-pin-DO8tcCZO.js";import{P as Re}from"./phone-Cb6lQLDB.js";import{A as We}from"./arrow-left-right-D_8GjPtL.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=fe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var Ke=["type","layout","connectNulls","ref"],Me=["key"];function D(e){"@babel/helpers - typeof";return D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},D(e)}function ne(e,s){if(e==null)return{};var n=qe(e,s),r,o;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(o=0;o<d.length;o++)r=d[o],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qe(e,s){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(s.indexOf(r)>=0)continue;n[r]=e[r]}return n}function B(){return B=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B.apply(this,arguments)}function se(e,s){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function v(e){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?se(Object(n),!0).forEach(function(r){j(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S(e){return Ge(e)||Ue(e)||ze(e)||Ve()}function Ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ze(e,s){if(e){if(typeof e=="string")return Y(e,s);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,s)}}function Ue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ge(e){if(Array.isArray(e))return Y(e)}function Y(e,s){(s==null||s>e.length)&&(s=e.length);for(var n=0,r=new Array(s);n<s;n++)r[n]=e[n];return r}function Xe(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function ie(e,s){for(var n=0;n<s.length;n++){var r=s[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pe(r.key),r)}}function Ye(e,s,n){return s&&ie(e.prototype,s),n&&ie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function He(e,s,n){return s=q(s),Qe(e,he()?Reflect.construct(s,n||[],q(e).constructor):s.apply(e,n))}function Qe(e,s){if(s&&(D(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Je(e)}function Je(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(he=function(){return!!e})()}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},q(e)}function Ze(e,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(s&&s.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),s&&H(e,s)}function H(e,s){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},H(e,s)}function j(e,s,n){return s=pe(s),s in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n,e}function pe(e){var s=et(e,"string");return D(s)=="symbol"?s:s+""}function et(e,s){if(D(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,s);if(D(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var R=function(e){function s(){var n;Xe(this,s);for(var r=arguments.length,o=new Array(r),d=0;d<r;d++)o[d]=arguments[d];return n=He(this,s,[].concat(o)),j(n,"state",{isAnimationFinished:!0,totalLength:0}),j(n,"generateSimpleStrokeDasharray",function(l,c){return"".concat(c,"px ").concat(l-c,"px")}),j(n,"getStrokeDasharray",function(l,c,m){var u=m.reduce(function(N,w){return N+w});if(!u)return n.generateSimpleStrokeDasharray(c,l);for(var a=Math.floor(l/u),i=l%u,h=c-l,x=[],p=0,g=0;p<m.length;g+=m[p],++p)if(g+m[p]>i){x=[].concat(S(m.slice(0,p)),[i-g]);break}var b=x.length%2===0?[0,h]:[h];return[].concat(S(s.repeat(m,a)),S(x),b).map(function(N){return"".concat(N,"px")}).join(", ")}),j(n,"id",Le("recharts-line-")),j(n,"pathRef",function(l){n.mainCurve=l}),j(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),j(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Ze(s,e),Ye(s,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var d=this.props,l=d.points,c=d.xAxis,m=d.yAxis,u=d.layout,a=d.children,i=Ae(a,Pe);if(!i)return null;var h=function(g,b){return{x:g.x,y:g.y,value:g.value,errorVal:le(g.payload,b)}},x={clipPath:r?"url(#clipPath-".concat(o,")"):null};return y.createElement(U,x,i.map(function(p){return y.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:l,xAxis:c,yAxis:m,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(r,o,d){var l=this.props.isAnimationActive;if(l&&!this.state.isAnimationFinished)return null;var c=this.props,m=c.dot,u=c.points,a=c.dataKey,i=M(this.props,!1),h=M(m,!0),x=u.map(function(g,b){var N=v(v(v({key:"dot-".concat(b),r:3},i),h),{},{index:b,cx:g.x,cy:g.y,value:g.value,dataKey:a,payload:g.payload,points:u});return s.renderDotItem(m,N)}),p={clipPath:r?"url(#clipPath-".concat(o?"":"dots-").concat(d,")"):null};return y.createElement(U,B({className:"recharts-line-dots",key:"dots"},p),x)}},{key:"renderCurveStatically",value:function(r,o,d,l){var c=this.props,m=c.type,u=c.layout,a=c.connectNulls;c.ref;var i=ne(c,Ke),h=v(v(v({},M(i,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(d,")"):null,points:r},l),{},{type:m,layout:u,connectNulls:a});return y.createElement(Oe,B({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,o){var d=this,l=this.props,c=l.points,m=l.strokeDasharray,u=l.isAnimationActive,a=l.animationBegin,i=l.animationDuration,h=l.animationEasing,x=l.animationId,p=l.animateNewValues,g=l.width,b=l.height,N=this.state,w=N.prevPoints,E=N.totalLength;return y.createElement(Se,{begin:a,duration:i,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(x),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(P){var _=P.t;if(w){var L=w.length/c.length,A=c.map(function(f,V){var $=Math.floor(V*L);if(w[$]){var I=w[$],O=F(I.x,f.x),xe=F(I.y,f.y);return v(v({},f),{},{x:O(_),y:xe(_)})}if(p){var ge=F(g*2,f.x),ye=F(b/2,f.y);return v(v({},f),{},{x:ge(_),y:ye(_)})}return v(v({},f),{},{x:f.x,y:f.y})});return d.renderCurveStatically(A,r,o)}var W=F(0,E),C=W(_),T;if(m){var K="".concat(m).split(/[,\s]+/gim).map(function(f){return parseFloat(f)});T=d.getStrokeDasharray(C,E,K)}else T=d.generateSimpleStrokeDasharray(E,C);return d.renderCurveStatically(c,r,o,{strokeDasharray:T})})}},{key:"renderCurve",value:function(r,o){var d=this.props,l=d.points,c=d.isAnimationActive,m=this.state,u=m.prevPoints,a=m.totalLength;return c&&l&&l.length&&(!u&&a>0||!ke(u,l))?this.renderCurveWithAnimation(r,o):this.renderCurveStatically(l,r,o)}},{key:"render",value:function(){var r,o=this.props,d=o.hide,l=o.dot,c=o.points,m=o.className,u=o.xAxis,a=o.yAxis,i=o.top,h=o.left,x=o.width,p=o.height,g=o.isAnimationActive,b=o.id;if(d||!c||!c.length)return null;var N=this.state.isAnimationFinished,w=c.length===1,E=Q("recharts-line",m),P=u&&u.allowDataOverflow,_=a&&a.allowDataOverflow,L=P||_,A=X(b)?this.id:b,W=(r=M(l,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},C=W.r,T=C===void 0?3:C,K=W.strokeWidth,f=K===void 0?2:K,V=De(l)?l:{},$=V.clipDot,I=$===void 0?!0:$,O=T*2+f;return y.createElement(U,{className:E},P||_?y.createElement("defs",null,y.createElement("clipPath",{id:"clipPath-".concat(A)},y.createElement("rect",{x:P?h:h-x/2,y:_?i:i-p/2,width:P?x:x*2,height:_?p:p*2})),!I&&y.createElement("clipPath",{id:"clipPath-dots-".concat(A)},y.createElement("rect",{x:h-O/2,y:i-O/2,width:x+O,height:p+O}))):null,!w&&this.renderCurve(L,A),this.renderErrorBar(L,A),(w||l)&&this.renderDots(L,I,A),(!g||N)&&Ee.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,o){return r.animationId!==o.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:o.curPoints}:r.points!==o.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,o){for(var d=r.length%2!==0?[].concat(S(r),[0]):r,l=[],c=0;c<o;++c)l=[].concat(S(l),S(d));return l}},{key:"renderDotItem",value:function(r,o){var d;if(y.isValidElement(r))d=y.cloneElement(r,o);else if(_e(r))d=r(o);else{var l=o.key,c=ne(o,Me),m=Q("recharts-line-dot",typeof r!="boolean"?r.className:"");d=y.createElement(we,B({key:l},c,{className:m}))}return d}}])}(ae.PureComponent);j(R,"displayName","Line");j(R,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ce.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});j(R,"getComposedData",function(e){var s=e.props,n=e.xAxis,r=e.yAxis,o=e.xAxisTicks,d=e.yAxisTicks,l=e.dataKey,c=e.bandSize,m=e.displayedData,u=e.offset,a=s.layout,i=m.map(function(h,x){var p=le(h,l);return a==="horizontal"?{x:te({axis:n,ticks:o,bandSize:c,entry:h,index:x}),y:X(p)?null:r.scale(p),value:p,payload:h}:{x:X(p)?null:n.scale(p),y:te({axis:r,ticks:d,bandSize:c,entry:h,index:x}),value:p,payload:h}});return v({points:i,layout:a},u)});var tt=Te({chartName:"LineChart",GraphicalChild:R,axisComponents:[{axisType:"xAxis",AxisComp:ce},{axisType:"yAxis",AxisComp:de}],formatAxisMap:$e});function dt(){const[e,s]=ae.useState("operations"),{data:n,isLoading:r}=J({queryKey:["dashboard"],queryFn:()=>ee.get().then(c=>c.data),enabled:e==="business"}),{data:o,isLoading:d}=J({queryKey:["dashboard-operations"],queryFn:()=>ee.getOperations().then(c=>c.data),enabled:e==="operations",refetchInterval:6e4});return(e==="business"?r:d)?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"דשבורד"}),t.jsx("p",{className:"text-gray-500",children:"ברוך הבא למערכת צוות יהלום"})]}),t.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[t.jsxs("button",{onClick:()=>s("operations"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${e==="operations"?"bg-primary-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[t.jsx(oe,{className:"w-4 h-4 inline-block ml-1"}),"תפעולי"]}),t.jsxs("button",{onClick:()=>s("business"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${e==="business"?"bg-primary-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[t.jsx(me,{className:"w-4 h-4 inline-block ml-1"}),"עסקי"]})]})]}),e==="operations"?t.jsx(rt,{data:o}):t.jsx(nt,{data:n})]})}function rt({data:e}){var n,r,o,d,l,c,m,u,a;const s=[{name:"מאבטחים בשטח",value:`${(e==null?void 0:e.guards_on_duty)||0}/${(e==null?void 0:e.guards_expected_today)||0}`,icon:oe,color:"bg-blue-500"},{name:"אתרים מכוסים",value:(e==null?void 0:e.sites_with_coverage)||0,icon:re,color:"bg-green-500"},{name:"אירועי אבטחה פתוחים",value:((n=e==null?void 0:e.open_incidents)==null?void 0:n.count)||0,icon:z,color:((r=e==null?void 0:e.open_incidents)==null?void 0:r.critical)>0?"bg-red-600":"bg-red-500",href:"/incidents"},{name:"רישיונות שפגים",value:((o=e==null?void 0:e.expiring_licenses)==null?void 0:o.length)||0,icon:G,color:"bg-yellow-500"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(i=>{const h=i.href?k:"div",x=i.href?{to:i.href}:{};return t.jsx(h,{...x,className:"stat-card hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"stat-card-value",children:i.value}),t.jsx("p",{className:"stat-card-label",children:i.name})]}),t.jsx("div",{className:`p-3 rounded-lg ${i.color}`,children:t.jsx(i.icon,{className:"w-6 h-6 text-white"})})]})},i.name)})}),((d=e==null?void 0:e.open_incidents)==null?void 0:d.critical)>0&&t.jsxs("div",{className:"bg-red-100 border border-red-300 rounded-lg p-4 flex items-center gap-3",children:[t.jsx(z,{className:"w-6 h-6 text-red-600 flex-shrink-0"}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-bold text-red-800",children:[e.open_incidents.critical," אירועי אבטחה קריטיים פתוחים!"]}),t.jsx(k,{to:"/incidents?severity=critical",className:"text-red-700 underline text-sm",children:"צפה באירועים"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(ue,{className:"w-5 h-5 text-red-500"}),"מאבטחים שלא עשו צ'ק-אין"]}),((l=e==null?void 0:e.guards_not_checked_in)==null?void 0:l.length)>0?t.jsx("div",{className:"space-y-3",children:e.guards_not_checked_in.map(i=>t.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium text-gray-900",children:[i.first_name," ",i.last_name]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[i.site_name||i.company_name," | ",i.start_time," - ",i.end_time]})]}),i.phone&&t.jsx("a",{href:`tel:${i.phone}`,className:"p-2 rounded-lg bg-red-100 hover:bg-red-200 transition-colors",title:"התקשר",children:t.jsx(Re,{className:"w-4 h-4 text-red-600"})})]},i.id))}):t.jsx("p",{className:"text-green-600 text-center py-8 font-medium",children:"✓ כל המאבטחים עשו צ'ק-אין"})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(re,{className:"w-5 h-5 text-orange-500"}),"אתרים ללא כיסוי"]}),((c=e==null?void 0:e.sites_without_coverage)==null?void 0:c.length)>0?t.jsx("div",{className:"space-y-3",children:e.sites_without_coverage.map(i=>t.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 border border-orange-100",children:[t.jsx("p",{className:"font-medium text-gray-900",children:i.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[i.company_name," | ",i.start_time," - ",i.end_time]}),i.address&&t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:i.address})]},i.id))}):t.jsx("p",{className:"text-green-600 text-center py-8 font-medium",children:"✓ כל האתרים מכוסים"})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(We,{className:"w-5 h-5 text-blue-500"}),"החלפות משמרות בשעתיים הקרובות"]}),((m=e==null?void 0:e.upcoming_shift_changes)==null?void 0:m.length)>0?t.jsx("div",{className:"space-y-3",children:e.upcoming_shift_changes.map(i=>t.jsxs("div",{className:"p-3 rounded-lg bg-blue-50 border border-blue-100 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:i.site_name||i.company_name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[i.start_time," - ",i.end_time," | ",i.assigned_count,"/",i.required_employees," משובצים"]})]}),t.jsx("span",{className:`badge ${i.change_type==="starting"?"badge-success":"badge-warning"}`,children:i.change_type==="starting"?"מתחילה":"מסתיימת"})]},i.id))}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"אין החלפות קרובות"})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(G,{className:"w-5 h-5 text-yellow-500"}),"רישיונות והסמכות שפגים ב-7 ימים"]}),((u=e==null?void 0:e.expiring_licenses)==null?void 0:u.length)>0?t.jsx("div",{className:"space-y-3",children:e.expiring_licenses.map(i=>t.jsx("div",{className:"p-3 rounded-lg bg-yellow-50 border border-yellow-100",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:i.employee_name}),t.jsx("p",{className:"text-sm text-gray-500",children:i.cert_name})]}),t.jsxs("span",{className:`text-sm font-bold ${i.days_left<=3?"text-red-600":"text-yellow-600"}`,children:[i.days_left," ימים"]})]})},i.id))}):t.jsx("p",{className:"text-green-600 text-center py-8 font-medium",children:"✓ אין רישיונות שפגים בקרוב"})]}),((a=e==null?void 0:e.today_incidents)==null?void 0:a.length)>0&&t.jsxs("div",{className:"card lg:col-span-2",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(z,{className:"w-5 h-5 text-red-500"}),"אירועי אבטחה היום"]}),t.jsx("div",{className:"space-y-3",children:e.today_incidents.map(i=>{const h={critical:"bg-red-100 border-red-300 text-red-800",high:"bg-orange-100 border-orange-300 text-orange-800",medium:"bg-yellow-100 border-yellow-300 text-yellow-800",low:"bg-green-100 border-green-300 text-green-800"},x={critical:"קריטי",high:"גבוה",medium:"בינוני",low:"נמוך"};return t.jsx(k,{to:"/incidents",className:"block p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold border ${h[i.severity]||h.low}`,children:x[i.severity]||i.severity}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:i.title}),t.jsxs("p",{className:"text-sm text-gray-500",children:[i.site_name||i.company_name," | ",i.incident_time]})]})]})})},i.id)})})]})]})]})}function nt({data:e}){var n,r,o,d,l,c,m,u;const s=[{name:"לידים חדשים",value:((n=e==null?void 0:e.leads)==null?void 0:n.new_leads)||0,icon:ve,color:"bg-blue-500",href:"/leads?status=new"},{name:"לקוחות פעילים",value:((r=e==null?void 0:e.customers)==null?void 0:r.active_customers)||0,icon:be,color:"bg-green-500",href:"/customers"},{name:"משמרות היום",value:((o=e==null?void 0:e.shiftsToday)==null?void 0:o.total)||0,icon:je,color:"bg-purple-500",href:"/shifts"},{name:"אירועים השבוע",value:((d=e==null?void 0:e.upcomingEvents)==null?void 0:d.length)||0,icon:Z,color:"bg-orange-500",href:"/events"}];return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(a=>t.jsx(k,{to:a.href,className:"stat-card hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"stat-card-value",children:a.value}),t.jsx("p",{className:"stat-card-label",children:a.name})]}),t.jsx("div",{className:`p-3 rounded-lg ${a.color}`,children:t.jsx(a.icon,{className:"w-6 h-6 text-white"})})]})},a.name))}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(me,{className:"w-5 h-5 text-primary-500"}),"הכנסות - 6 חודשים אחרונים"]}),t.jsx("div",{className:"h-64",children:t.jsx(Ie,{width:"100%",height:"100%",children:t.jsxs(tt,{data:(e==null?void 0:e.monthlyRevenue)||[],children:[t.jsx(Fe,{strokeDasharray:"3 3"}),t.jsx(ce,{dataKey:"month"}),t.jsx(de,{}),t.jsx(Be,{formatter:a=>[`₪${a==null?void 0:a.toLocaleString()}`,"הכנסות"]}),t.jsx(R,{type:"monotone",dataKey:"revenue",stroke:"#0ea5e9",strokeWidth:2})]})})})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(Z,{className:"w-5 h-5 text-orange-500"}),"אירועים קרובים"]}),((l=e==null?void 0:e.upcomingEvents)==null?void 0:l.length)>0?t.jsx("div",{className:"space-y-3",children:e.upcomingEvents.map(a=>t.jsx(k,{to:`/events/${a.id}`,className:"block p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:a.event_name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[a.event_date," | ",a.start_time," | ",a.company_name]})]}),t.jsxs("span",{className:`badge ${a.assigned_count>=a.required_guards?"badge-success":"badge-warning"}`,children:[a.assigned_count,"/",a.required_guards," משובצים"]})]})},a.id))}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"אין אירועים קרובים"})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(ue,{className:"w-5 h-5 text-red-500"}),"משמרות לא מאוישות היום"]}),((c=e==null?void 0:e.unassignedShifts)==null?void 0:c.length)>0?t.jsx("div",{className:"space-y-3",children:e.unassignedShifts.map(a=>t.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100",children:[t.jsxs("p",{className:"font-medium text-gray-900",children:[a.company_name," - ",a.site_name]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[a.start_time," - ",a.end_time]})]},a.id))}):t.jsx("p",{className:"text-green-600 text-center py-8",children:"✓ כל המשמרות מאוישות"})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(G,{className:"w-5 h-5 text-yellow-500"}),"חשבוניות באיחור"]}),((m=e==null?void 0:e.overdueInvoices)==null?void 0:m.length)>0?t.jsx("div",{className:"space-y-3",children:e.overdueInvoices.map(a=>{var i;return t.jsx("div",{className:"p-3 rounded-lg bg-yellow-50 border border-yellow-100",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:a.company_name}),t.jsxs("p",{className:"text-sm text-gray-500",children:["חשבונית #",a.invoice_number]})]}),t.jsxs("div",{className:"text-left",children:[t.jsxs("p",{className:"font-bold text-gray-900",children:["₪",(i=a.total_amount)==null?void 0:i.toLocaleString()]}),t.jsxs("p",{className:"text-sm text-red-600",children:[a.days_overdue," ימים באיחור"]})]})]})},a.id)})}):t.jsx("p",{className:"text-green-600 text-center py-8",children:"✓ אין חשבוניות באיחור"})]}),((u=e==null?void 0:e.contractsExpiring)==null?void 0:u.length)>0&&t.jsxs("div",{className:"card lg:col-span-2",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(Ne,{className:"w-5 h-5 text-blue-500"}),"חוזים לחידוש בקרוב"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:e.contractsExpiring.map(a=>{var i;return t.jsxs(k,{to:`/customers/${a.customer_id}`,className:"p-3 rounded-lg bg-blue-50 border border-blue-100 hover:bg-blue-100 transition-colors",children:[t.jsx("p",{className:"font-medium text-gray-900",children:a.company_name}),t.jsxs("p",{className:"text-sm text-gray-500",children:["תום חוזה: ",a.end_date," | ₪",(i=a.monthly_value)==null?void 0:i.toLocaleString(),"/חודש"]})]},a.id)})})]})]})]})}export{dt as default};
