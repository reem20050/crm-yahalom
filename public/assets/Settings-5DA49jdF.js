import{c as q,h as C,r as k,e as F,i as r,j as e,X as p,n as M,z as t,a3 as n}from"./index-BGOlPzIM.js";import{u as S}from"./index.esm-BhRLWoPf.js";import{M as I}from"./mail-CJEfDuQ6.js";import{C as u}from"./check-DLqnFAj4.js";import{M as P}from"./message-circle-AdCrSfsj.js";import{E as c}from"./external-link-jhdPeFE6.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=q("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=q("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);function B(){const i=C(),[N,d]=k.useState(!1),[y,m]=k.useState(!1),{data:s,isLoading:A}=F({queryKey:["integrationSettings"],queryFn:async()=>(await n.get("/integrations/settings")).data}),l=S(),o=S(),b=r({mutationFn:async()=>(await n.get("/integrations/google/auth-url")).data.authUrl,onSuccess:a=>{window.location.href=a},onError:()=>{t.error("שגיאה בהתחברות ל-Google")}}),f=r({mutationFn:()=>n.post("/integrations/google/disconnect"),onSuccess:()=>{i.invalidateQueries({queryKey:["integrationSettings"]}),t.success("Google נותק בהצלחה")}}),x=r({mutationFn:a=>n.post("/integrations/whatsapp/settings",a),onSuccess:()=>{i.invalidateQueries({queryKey:["integrationSettings"]}),t.success("WhatsApp הוגדר בהצלחה"),d(!1)},onError:()=>{t.error("שגיאה בשמירת הגדרות WhatsApp")}}),v=r({mutationFn:()=>n.post("/integrations/whatsapp/disconnect"),onSuccess:()=>{i.invalidateQueries({queryKey:["integrationSettings"]}),t.success("WhatsApp נותק בהצלחה")}}),h=r({mutationFn:a=>n.post("/integrations/green-invoice/settings",a),onSuccess:()=>{i.invalidateQueries({queryKey:["integrationSettings"]}),t.success("חשבונית ירוקה הוגדרה בהצלחה"),m(!1)},onError:()=>{t.error("שגיאה בחיבור לחשבונית ירוקה - בדוק את פרטי ההתחברות")}}),w=r({mutationFn:()=>n.post("/integrations/green-invoice/disconnect"),onSuccess:()=>{i.invalidateQueries({queryKey:["integrationSettings"]}),t.success("חשבונית ירוקה נותקה בהצלחה")}});return A?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"הגדרות"}),e.jsx("p",{className:"text-gray-500",children:"ניהול אינטגרציות וחיבורים חיצוניים"})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Google Workspace"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Gmail, Calendar, Drive"})]}),s!=null&&s.google.connected?e.jsxs("span",{className:"badge badge-success flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),"מחובר"]}):e.jsxs("span",{className:"badge badge-gray flex items-center gap-1",children:[e.jsx(p,{className:"w-3 h-3"}),"לא מחובר"]})]}),s!=null&&s.google.connected?e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["מחובר כ: ",e.jsx("span",{className:"font-medium",children:s.google.email})]}),e.jsxs("button",{onClick:()=>f.mutate(),disabled:f.isPending,className:"btn-secondary text-red-600 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),"נתק"]})]}):e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"חבר את חשבון Google שלך כדי לשלוח מיילים, לסנכרן יומן ולשמור מסמכים"}),e.jsxs("button",{onClick:()=>b.mutate(),disabled:b.isPending,className:"btn-primary flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"}),"התחבר עם Google"]})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(P,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"WhatsApp Business"}),e.jsx("p",{className:"text-sm text-gray-500",children:"שליחת הודעות אוטומטיות"})]}),s!=null&&s.whatsapp.connected?e.jsxs("span",{className:"badge badge-success flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),"מחובר"]}):e.jsxs("span",{className:"badge badge-gray flex items-center gap-1",children:[e.jsx(p,{className:"w-3 h-3"}),"לא מחובר"]})]}),s!=null&&s.whatsapp.connected&&!N?e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["מספר: ",e.jsx("span",{className:"font-medium",children:s.whatsapp.phoneNumber})]}),e.jsxs("button",{onClick:()=>v.mutate(),disabled:v.isPending,className:"btn-secondary text-red-600 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),"נתק"]})]}):N?e.jsxs("form",{onSubmit:l.handleSubmit(a=>x.mutate(a)),className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone Number ID"}),e.jsx("input",{...l.register("phoneNumberId",{required:!0}),className:"input",dir:"ltr",placeholder:"מתוך Meta Business"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"מספר להצגה"}),e.jsx("input",{...l.register("phoneDisplay"),className:"input",dir:"ltr",placeholder:"050-1234567"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"label",children:"Access Token"}),e.jsx("input",{...l.register("accessToken",{required:!0}),type:"password",className:"input",dir:"ltr",placeholder:"מתוך Meta Business"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:x.isPending,className:"btn-primary",children:x.isPending?"שומר...":"שמור"}),e.jsx("button",{type:"button",onClick:()=>d(!1),className:"btn-secondary",children:"ביטול"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:e.jsxs("a",{href:"https://business.facebook.com/settings/whatsapp-business-accounts",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline flex items-center gap-1",children:["איך להשיג את הפרטים",e.jsx(c,{className:"w-3 h-3"})]})})]}):e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"חבר את WhatsApp Business כדי לשלוח תזכורות משמרות, אישורי הזמנות ועוד"}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"}),"הגדר WhatsApp"]})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(M,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"חשבונית ירוקה"}),e.jsx("p",{className:"text-sm text-gray-500",children:"הפקת חשבוניות וקבלות"})]}),s!=null&&s.greenInvoice.connected?e.jsxs("span",{className:"badge badge-success flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),"מחובר"]}):e.jsxs("span",{className:"badge badge-gray flex items-center gap-1",children:[e.jsx(p,{className:"w-3 h-3"}),"לא מחובר"]})]}),s!=null&&s.greenInvoice.connected&&!y?e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["עסק: ",e.jsx("span",{className:"font-medium",children:s.greenInvoice.businessName})]}),e.jsxs("button",{onClick:()=>w.mutate(),disabled:w.isPending,className:"btn-secondary text-red-600 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),"נתק"]})]}):y?e.jsxs("form",{onSubmit:o.handleSubmit(a=>h.mutate(a)),className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"API Key"}),e.jsx("input",{...o.register("apiKey",{required:!0}),className:"input",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"API Secret"}),e.jsx("input",{...o.register("apiSecret",{required:!0}),type:"password",className:"input",dir:"ltr"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:h.isPending,className:"btn-primary",children:h.isPending?"מתחבר...":"התחבר"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn-secondary",children:"ביטול"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:e.jsxs("a",{href:"https://www.greeninvoice.co.il/api-docs/",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline flex items-center gap-1",children:["מדריך לקבלת מפתחות API",e.jsx(c,{className:"w-3 h-3"})]})})]}):e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"חבר את חשבונית ירוקה כדי להפיק חשבוניות וקבלות ישירות מהמערכת"}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"}),"הגדר חשבונית ירוקה"]})]})]})]})})]}),e.jsxs("div",{className:"card bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"צריך עזרה?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"למדריכים מפורטים על הגדרת האינטגרציות, פנה לתמיכה הטכנית או עיין בתיעוד."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("a",{href:"#",className:"text-primary-600 text-sm hover:underline flex items-center gap-1",children:["מדריך Google Workspace",e.jsx(c,{className:"w-3 h-3"})]}),e.jsxs("a",{href:"#",className:"text-primary-600 text-sm hover:underline flex items-center gap-1",children:["מדריך WhatsApp Business",e.jsx(c,{className:"w-3 h-3"})]}),e.jsxs("a",{href:"#",className:"text-primary-600 text-sm hover:underline flex items-center gap-1",children:["מדריך חשבונית ירוקה",e.jsx(c,{className:"w-3 h-3"})]})]})]})]})}export{B as default};
