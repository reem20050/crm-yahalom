import{c as de,G as _,H as q,I as Z,_ as qe,J as De,K as Ee,h as se,r as O,e as Y,i as $,j as e,X as re,z as p,M as J,C as Ue,m as je,N as we,f as Ne,A as _e,O as me,n as Pe,Q as ee,U as le,T as K,E as $e,V as Ye,q as We}from"./index-BGOlPzIM.js";import{u as Fe}from"./index.esm-BhRLWoPf.js";import{t as Le,o as Qe,s as B,b as he,n as Ke}from"./types-JheIi145.js";import{C as ke}from"./check-circle-DWpwOSm_.js";import{P as xe}from"./plus-BSkoP1vL.js";import{T as Ce}from"./trash-2-D90EavDq.js";import{C as Ae,a as He}from"./chevron-right-B1kwH_PQ.js";import{S as oe}from"./shield-C9G2romd.js";import{C as ce}from"./car-DkmkUfu7.js";import{M as fe}from"./map-pin-DO8tcCZO.js";import{S as Ge}from"./send-yGBxB0GN.js";import{M as Ie}from"./message-circle-AdCrSfsj.js";import{U as Re}from"./user-plus-DjuYI1Sk.js";/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=de("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=de("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=de("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function F(n){if(n===null||n===!0||n===!1)return NaN;var a=Number(n);return isNaN(a)?a:a<0?Math.ceil(a):Math.floor(a)}function z(n,a){_(2,arguments);var t=q(n),r=F(a);return isNaN(r)?new Date(NaN):(r&&t.setDate(t.getDate()+r),t)}function Ve(n,a){_(2,arguments);var t=q(n).getTime(),r=F(a);return new Date(t+r)}function ze(n,a){var t,r,s,i,l,h,x,f;_(1,arguments);var g=Z(),c=F((t=(r=(s=(i=a==null?void 0:a.weekStartsOn)!==null&&i!==void 0?i:a==null||(l=a.locale)===null||l===void 0||(h=l.options)===null||h===void 0?void 0:h.weekStartsOn)!==null&&s!==void 0?s:g.weekStartsOn)!==null&&r!==void 0?r:(x=g.locale)===null||x===void 0||(f=x.options)===null||f===void 0?void 0:f.weekStartsOn)!==null&&t!==void 0?t:0);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=q(n),o=u.getDay(),v=(o<c?7:0)+o-c;return u.setDate(u.getDate()-v),u.setHours(0,0,0,0),u}function Je(n){return _(1,arguments),n instanceof Date||qe(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function Ze(n){if(_(1,arguments),!Je(n)&&typeof n!="number")return!1;var a=q(n);return!isNaN(Number(a))}function et(n,a){_(2,arguments);var t=F(a);return Ve(n,-t)}var tt=864e5;function at(n){_(1,arguments);var a=q(n),t=a.getTime();a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0);var r=a.getTime(),s=t-r;return Math.floor(s/tt)+1}function te(n){_(1,arguments);var a=1,t=q(n),r=t.getUTCDay(),s=(r<a?7:0)+r-a;return t.setUTCDate(t.getUTCDate()-s),t.setUTCHours(0,0,0,0),t}function Se(n){_(1,arguments);var a=q(n),t=a.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(t+1,0,4),r.setUTCHours(0,0,0,0);var s=te(r),i=new Date(0);i.setUTCFullYear(t,0,4),i.setUTCHours(0,0,0,0);var l=te(i);return a.getTime()>=s.getTime()?t+1:a.getTime()>=l.getTime()?t:t-1}function st(n){_(1,arguments);var a=Se(n),t=new Date(0);t.setUTCFullYear(a,0,4),t.setUTCHours(0,0,0,0);var r=te(t);return r}var rt=6048e5;function nt(n){_(1,arguments);var a=q(n),t=te(a).getTime()-st(a).getTime();return Math.round(t/rt)+1}function ae(n,a){var t,r,s,i,l,h,x,f;_(1,arguments);var g=Z(),c=F((t=(r=(s=(i=a==null?void 0:a.weekStartsOn)!==null&&i!==void 0?i:a==null||(l=a.locale)===null||l===void 0||(h=l.options)===null||h===void 0?void 0:h.weekStartsOn)!==null&&s!==void 0?s:g.weekStartsOn)!==null&&r!==void 0?r:(x=g.locale)===null||x===void 0||(f=x.options)===null||f===void 0?void 0:f.weekStartsOn)!==null&&t!==void 0?t:0);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=q(n),o=u.getUTCDay(),v=(o<c?7:0)+o-c;return u.setUTCDate(u.getUTCDate()-v),u.setUTCHours(0,0,0,0),u}function Oe(n,a){var t,r,s,i,l,h,x,f;_(1,arguments);var g=q(n),c=g.getUTCFullYear(),u=Z(),o=F((t=(r=(s=(i=a==null?void 0:a.firstWeekContainsDate)!==null&&i!==void 0?i:a==null||(l=a.locale)===null||l===void 0||(h=l.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&r!==void 0?r:(x=u.locale)===null||x===void 0||(f=x.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(o>=1&&o<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(c+1,0,o),v.setUTCHours(0,0,0,0);var k=ae(v,a),C=new Date(0);C.setUTCFullYear(c,0,o),C.setUTCHours(0,0,0,0);var D=ae(C,a);return g.getTime()>=k.getTime()?c+1:g.getTime()>=D.getTime()?c:c-1}function it(n,a){var t,r,s,i,l,h,x,f;_(1,arguments);var g=Z(),c=F((t=(r=(s=(i=a==null?void 0:a.firstWeekContainsDate)!==null&&i!==void 0?i:a==null||(l=a.locale)===null||l===void 0||(h=l.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&s!==void 0?s:g.firstWeekContainsDate)!==null&&r!==void 0?r:(x=g.locale)===null||x===void 0||(f=x.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&t!==void 0?t:1),u=Oe(n,a),o=new Date(0);o.setUTCFullYear(u,0,c),o.setUTCHours(0,0,0,0);var v=ae(o,a);return v}var lt=6048e5;function ot(n,a){_(1,arguments);var t=q(n),r=ae(t,a).getTime()-it(t,a).getTime();return Math.round(r/lt)+1}function y(n,a){for(var t=n<0?"-":"",r=Math.abs(n).toString();r.length<a;)r="0"+r;return t+r}var Q={y:function(a,t){var r=a.getUTCFullYear(),s=r>0?r:1-r;return y(t==="yy"?s%100:s,t.length)},M:function(a,t){var r=a.getUTCMonth();return t==="M"?String(r+1):y(r+1,2)},d:function(a,t){return y(a.getUTCDate(),t.length)},a:function(a,t){var r=a.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(a,t){return y(a.getUTCHours()%12||12,t.length)},H:function(a,t){return y(a.getUTCHours(),t.length)},m:function(a,t){return y(a.getUTCMinutes(),t.length)},s:function(a,t){return y(a.getUTCSeconds(),t.length)},S:function(a,t){var r=t.length,s=a.getUTCMilliseconds(),i=Math.floor(s*Math.pow(10,r-3));return y(i,t.length)}},X={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ct={G:function(a,t,r){var s=a.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(a,t,r){if(t==="yo"){var s=a.getUTCFullYear(),i=s>0?s:1-s;return r.ordinalNumber(i,{unit:"year"})}return Q.y(a,t)},Y:function(a,t,r,s){var i=Oe(a,s),l=i>0?i:1-i;if(t==="YY"){var h=l%100;return y(h,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):y(l,t.length)},R:function(a,t){var r=Se(a);return y(r,t.length)},u:function(a,t){var r=a.getUTCFullYear();return y(r,t.length)},Q:function(a,t,r){var s=Math.ceil((a.getUTCMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return y(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(a,t,r){var s=Math.ceil((a.getUTCMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return y(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(a,t,r){var s=a.getUTCMonth();switch(t){case"M":case"MM":return Q.M(a,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(a,t,r){var s=a.getUTCMonth();switch(t){case"L":return String(s+1);case"LL":return y(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(a,t,r,s){var i=ot(a,s);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):y(i,t.length)},I:function(a,t,r){var s=nt(a);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):y(s,t.length)},d:function(a,t,r){return t==="do"?r.ordinalNumber(a.getUTCDate(),{unit:"date"}):Q.d(a,t)},D:function(a,t,r){var s=at(a);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):y(s,t.length)},E:function(a,t,r){var s=a.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(a,t,r,s){var i=a.getUTCDay(),l=(i-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return y(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(a,t,r,s){var i=a.getUTCDay(),l=(i-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return y(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(a,t,r){var s=a.getUTCDay(),i=s===0?7:s;switch(t){case"i":return String(i);case"ii":return y(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(a,t,r){var s=a.getUTCHours(),i=s/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(a,t,r){var s=a.getUTCHours(),i;switch(s===12?i=X.noon:s===0?i=X.midnight:i=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(a,t,r){var s=a.getUTCHours(),i;switch(s>=17?i=X.evening:s>=12?i=X.afternoon:s>=4?i=X.morning:i=X.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(a,t,r){if(t==="ho"){var s=a.getUTCHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return Q.h(a,t)},H:function(a,t,r){return t==="Ho"?r.ordinalNumber(a.getUTCHours(),{unit:"hour"}):Q.H(a,t)},K:function(a,t,r){var s=a.getUTCHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):y(s,t.length)},k:function(a,t,r){var s=a.getUTCHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):y(s,t.length)},m:function(a,t,r){return t==="mo"?r.ordinalNumber(a.getUTCMinutes(),{unit:"minute"}):Q.m(a,t)},s:function(a,t,r){return t==="so"?r.ordinalNumber(a.getUTCSeconds(),{unit:"second"}):Q.s(a,t)},S:function(a,t){return Q.S(a,t)},X:function(a,t,r,s){var i=s._originalDate||a,l=i.getTimezoneOffset();if(l===0)return"Z";switch(t){case"X":return ve(l);case"XXXX":case"XX":return I(l);case"XXXXX":case"XXX":default:return I(l,":")}},x:function(a,t,r,s){var i=s._originalDate||a,l=i.getTimezoneOffset();switch(t){case"x":return ve(l);case"xxxx":case"xx":return I(l);case"xxxxx":case"xxx":default:return I(l,":")}},O:function(a,t,r,s){var i=s._originalDate||a,l=i.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ge(l,":");case"OOOO":default:return"GMT"+I(l,":")}},z:function(a,t,r,s){var i=s._originalDate||a,l=i.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ge(l,":");case"zzzz":default:return"GMT"+I(l,":")}},t:function(a,t,r,s){var i=s._originalDate||a,l=Math.floor(i.getTime()/1e3);return y(l,t.length)},T:function(a,t,r,s){var i=s._originalDate||a,l=i.getTime();return y(l,t.length)}};function ge(n,a){var t=n>0?"-":"+",r=Math.abs(n),s=Math.floor(r/60),i=r%60;if(i===0)return t+String(s);var l=a;return t+String(s)+l+y(i,2)}function ve(n,a){if(n%60===0){var t=n>0?"-":"+";return t+y(Math.abs(n)/60,2)}return I(n,a)}function I(n,a){var t=a||"",r=n>0?"-":"+",s=Math.abs(n),i=y(Math.floor(s/60),2),l=y(s%60,2);return r+i+t+l}var ye=function(a,t){switch(a){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Me=function(a,t){switch(a){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},dt=function(a,t){var r=a.match(/(P+)(p+)?/)||[],s=r[1],i=r[2];if(!i)return ye(a,t);var l;switch(s){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",ye(s,t)).replace("{{time}}",Me(i,t))},ut={p:Me,P:dt},mt=["D","DD"],ht=["YY","YYYY"];function xt(n){return mt.indexOf(n)!==-1}function ft(n){return ht.indexOf(n)!==-1}function pe(n,a,t){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(a,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(a,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(a,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(a,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var gt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yt=/^'([^]*?)'?$/,pt=/''/g,bt=/[a-zA-Z]/;function S(n,a,t){var r,s,i,l,h,x,f,g,c,u,o,v,k,C,D,M,T,E;_(2,arguments);var R=String(a),U=Z(),j=(r=(s=t==null?void 0:t.locale)!==null&&s!==void 0?s:U.locale)!==null&&r!==void 0?r:De,A=F((i=(l=(h=(x=t==null?void 0:t.firstWeekContainsDate)!==null&&x!==void 0?x:t==null||(f=t.locale)===null||f===void 0||(g=f.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&h!==void 0?h:U.firstWeekContainsDate)!==null&&l!==void 0?l:(c=U.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var W=F((o=(v=(k=(C=t==null?void 0:t.weekStartsOn)!==null&&C!==void 0?C:t==null||(D=t.locale)===null||D===void 0||(M=D.options)===null||M===void 0?void 0:M.weekStartsOn)!==null&&k!==void 0?k:U.weekStartsOn)!==null&&v!==void 0?v:(T=U.locale)===null||T===void 0||(E=T.options)===null||E===void 0?void 0:E.weekStartsOn)!==null&&o!==void 0?o:0);if(!(W>=0&&W<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!j.localize)throw new RangeError("locale must contain localize property");if(!j.formatLong)throw new RangeError("locale must contain formatLong property");var d=q(n);if(!Ze(d))throw new RangeError("Invalid time value");var b=Ee(d),V=et(d,b),ne={firstWeekContainsDate:A,weekStartsOn:W,locale:j,_originalDate:d},ie=R.match(vt).map(function(w){var P=w[0];if(P==="p"||P==="P"){var H=ut[P];return H(w,j.formatLong)}return w}).join("").match(gt).map(function(w){if(w==="''")return"'";var P=w[0];if(P==="'")return jt(w);var H=ct[P];if(H)return!(t!=null&&t.useAdditionalWeekYearTokens)&&ft(w)&&pe(w,a,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&xt(w)&&pe(w,a,String(n)),H(V,w,j.localize,ne);if(P.match(bt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");return w}).join("");return ie}function jt(n){var a=n.match(yt);return a?a[1].replace(pt,"'"):n}const wt=[{value:0,label:"×¨××©×•×Ÿ"},{value:1,label:"×©× ×™"},{value:2,label:"×©×œ×™×©×™"},{value:3,label:"×¨×‘×™×¢×™"},{value:4,label:"×—××™×©×™"},{value:5,label:"×©×™×©×™"},{value:6,label:"×©×‘×ª"}],Nt=[{value:"regular",label:"×¨×’×™×œ×”"},{value:"night",label:"×œ×™×œ×”"},{value:"weekend",label:"×¡×•×£ ×©×‘×•×¢"},{value:"holiday",label:"×—×’"}];function _t({template:n,onClose:a}){var c,u;const t=se(),r=!!n,[s,i]=O.useState({name:(n==null?void 0:n.name)||"",customer_id:(n==null?void 0:n.customer_id)||"",site_id:(n==null?void 0:n.site_id)||"",start_time:(n==null?void 0:n.start_time)||"08:00",end_time:(n==null?void 0:n.end_time)||"16:00",required_employees:(n==null?void 0:n.required_employees)||1,requires_weapon:!!(n!=null&&n.requires_weapon),requires_vehicle:!!(n!=null&&n.requires_vehicle),days_of_week:n!=null&&n.days_of_week?typeof n.days_of_week=="string"?JSON.parse(n.days_of_week):n.days_of_week:[],shift_type:(n==null?void 0:n.shift_type)||"regular",default_notes:(n==null?void 0:n.default_notes)||""}),{data:l}=Y({queryKey:["customers-list"],queryFn:()=>je.getAll({limit:100,status:"active"}).then(o=>o.data)}),{data:h}=Y({queryKey:["sites",s.customer_id],queryFn:()=>s.customer_id?we.getByCustomer(s.customer_id).then(o=>o.data):Promise.resolve({sites:[]}),enabled:!!s.customer_id}),x=$({mutationFn:o=>r?J.update(n.id,o):J.create(o),onSuccess:()=>{t.invalidateQueries({queryKey:["shift-templates"]}),p.success(r?"×”×ª×‘× ×™×ª ×¢×•×“×›× ×”":"×”×ª×‘× ×™×ª × ×•×¦×¨×”"),a()},onError:()=>p.error("×©×’×™××” ×‘×©××™×¨×ª ×ª×‘× ×™×ª")}),f=o=>{if(o.preventDefault(),!s.name.trim())return p.error("× × ×œ×”×–×™×Ÿ ×©× ×œ×ª×‘× ×™×ª");if(s.days_of_week.length===0)return p.error("× × ×œ×‘×—×•×¨ ×™××™× ×‘×©×‘×•×¢");x.mutate(s)},g=o=>{i(v=>({...v,days_of_week:v.days_of_week.includes(o)?v.days_of_week.filter(k=>k!==o):[...v.days_of_week,o].sort()}))};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:r?"×¢×¨×™×›×ª ×ª×‘× ×™×ª":"×ª×‘× ×™×ª ××©××¨×ª ×—×“×©×”"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×©× ×”×ª×‘× ×™×ª *"}),e.jsx("input",{value:s.name,onChange:o=>i({...s,name:o.target.value}),className:"input",placeholder:'×œ×“×•×’×³ "×©××™×¨×” ×œ×™×œ×™×ª - ××’×“×œ×™ ×¢×–×¨×™××œ×™"'})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×œ×§×•×—"}),e.jsxs("select",{value:s.customer_id,onChange:o=>i({...s,customer_id:o.target.value,site_id:""}),className:"input",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×œ×§×•×—..."}),(c=l==null?void 0:l.customers)==null?void 0:c.map(o=>e.jsx("option",{value:o.id,children:o.company_name},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"××ª×¨"}),e.jsxs("select",{value:s.site_id,onChange:o=>i({...s,site_id:o.target.value}),className:"input",disabled:!s.customer_id,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××ª×¨..."}),(u=h==null?void 0:h.sites)==null?void 0:u.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×©×¢×ª ×”×ª×—×œ×” *"}),e.jsx("input",{type:"time",value:s.start_time,onChange:o=>i({...s,start_time:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:s.end_time,onChange:o=>i({...s,end_time:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×¢×•×‘×“×™× × ×“×¨×©×™×"}),e.jsx("input",{type:"number",min:"1",value:s.required_employees,onChange:o=>i({...s,required_employees:parseInt(o.target.value)||1}),className:"input"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×¡×•×’ ××©××¨×ª"}),e.jsx("select",{value:s.shift_type,onChange:o=>i({...s,shift_type:o.target.value}),className:"input",children:Nt.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×™××™× ×‘×©×‘×•×¢ *"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:wt.map(o=>e.jsx("button",{type:"button",onClick:()=>g(o.value),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${s.days_of_week.includes(o.value)?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:o.label},o.value))})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.requires_weapon,onChange:o=>i({...s,requires_weapon:o.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("span",{children:"× ×“×¨×© × ×©×§"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.requires_vehicle,onChange:o=>i({...s,requires_vehicle:o.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("span",{children:"× ×“×¨×© ×¨×›×‘"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×”×¢×¨×•×ª ×‘×¨×™×¨×ª ××—×“×œ"}),e.jsx("textarea",{value:s.default_notes,onChange:o=>i({...s,default_notes:o.target.value}),className:"input min-h-[60px]",placeholder:"×”×¢×¨×•×ª ×©×™×™×›×œ×œ×• ×‘×›×œ ××©××¨×ª ×©×ª×™×•×•×¦×¨..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:x.isPending,className:"btn-primary flex-1",children:x.isPending?"×©×•××¨...":r?"×¢×“×›×Ÿ ×ª×‘× ×™×ª":"×¦×•×¨ ×ª×‘× ×™×ª"}),e.jsx("button",{type:"button",onClick:a,className:"btn-secondary",children:"×‘×™×˜×•×œ"})]})]})]})})}function kt({templateId:n,templateName:a,onClose:t}){const r=se(),[s,i]=O.useState(""),[l,h]=O.useState(""),x=$({mutationFn:()=>J.generate(n,s,l),onSuccess:g=>{r.invalidateQueries({queryKey:["shifts"]}),p.success(g.data.message||"××©××¨×•×ª × ×•×¦×¨×• ×‘×”×¦×œ×—×”"),t()},onError:()=>p.error("×©×’×™××” ×‘×™×¦×™×¨×ª ××©××¨×•×ª ××ª×‘× ×™×ª")}),f=g=>{if(g.preventDefault(),!s||!l)return p.error("× × ×œ×‘×—×•×¨ ×˜×•×•×— ×ª××¨×™×›×™×");if(l<s)return p.error("×ª××¨×™×š ×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ××—×¨×™ ×ª××¨×™×š ×”×ª×—×œ×”");x.mutate()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5"}),"×™×¦×™×¨×ª ××©××¨×•×ª ××ª×‘× ×™×ª"]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 mb-2",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"×ª×‘× ×™×ª:"})," ",a]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"××ª××¨×™×š *"}),e.jsx("input",{type:"date",value:s,onChange:g=>i(g.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×¢×“ ×ª××¨×™×š *"}),e.jsx("input",{type:"date",value:l,onChange:g=>h(g.target.value),className:"input"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:x.isPending,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:x.isPending?"×™×•×¦×¨...":e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4"}),"×¦×•×¨ ××©××¨×•×ª"]})}),e.jsx("button",{type:"button",onClick:t,className:"btn-secondary",children:"×‘×™×˜×•×œ"})]})]})]})})}const be={ok:{icon:ke,color:"text-green-500",label:"×ª×§×™×Ÿ"},issue_found:{icon:_e,color:"text-yellow-500",label:"× ××¦××” ×‘×¢×™×”"},requires_attention:{icon:Xe,color:"text-red-500",label:"×“×•×¨×© ×˜×™×¤×•×œ"}};function Ct({siteId:n,assignmentId:a}){const{data:t,isLoading:r}=Y({queryKey:["patrols-site-today",n],queryFn:()=>me.getSiteToday(n).then(u=>u.data),enabled:!!n&&!a}),{data:s,isLoading:i}=Y({queryKey:["patrols-shift",a],queryFn:()=>me.getShiftLogs(a).then(u=>u.data),enabled:!!a}),l=r||i,h=a?s==null?void 0:s.logs:t==null?void 0:t.logs,x=(t==null?void 0:t.checkpoints)||[],f=(t==null?void 0:t.total_checkpoints)||x.length,g=(t==null?void 0:t.visited_today)||0,c=f>0?Math.round(g/f*100):0;return l?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-primary-500 border-t-transparent"})}):e.jsxs("div",{className:"space-y-4",children:[!a&&f>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"×”×ª×§×“××•×ª ×¡×™×•×¨×™× ×”×™×•×"}),e.jsxs("span",{className:"font-medium",children:[g,"/",f," (",c,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${c>=80?"bg-green-500":c>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${c}%`}})})]}),!a&&x.length>0&&e.jsx("div",{className:"space-y-1",children:x.map(u=>{const o=h==null?void 0:h.some(v=>v.checkpoint_id===u.id);return e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded text-sm ${o?"bg-green-50 text-green-800":"bg-gray-50 text-gray-600"}`,children:[o?e.jsx(ke,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):e.jsx(Ne,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:u.name}),u.description&&e.jsxs("span",{className:"text-xs text-gray-400",children:["- ",u.description]})]},u.id)})}),h&&h.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"×¨×™×©×•× ×¡×™×•×¨×™×"}),h.map(u=>{const o=be[u.status]||be.ok,v=o.icon;return e.jsxs("div",{className:"flex items-start gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx(v,{className:`w-5 h-5 mt-0.5 flex-shrink-0 ${o.color}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium text-sm",children:u.checkpoint_name||"× ×§×•×“×ª ×‘×™×§×•×¨×ª"}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(u.checked_at).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})})]}),u.employee_name&&e.jsx("p",{className:"text-xs text-gray-500",children:u.employee_name}),u.observation&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:u.observation}),e.jsx("span",{className:`text-xs ${o.color}`,children:o.label})]})]},u.id)})]}):e.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"××™×Ÿ ×¨×™×©×•××™ ×¡×™×•×¨×™×"})]})}function Tt(n){return n.replace(/[\s\-+]/g,"")}const St=Qe({site_id:B().optional(),customer_id:B().optional(),date:B().min(1,"× ×“×¨×© ×ª××¨×™×š"),start_time:B().min(1,"× ×“×¨×©×ª ×©×¢×ª ×”×ª×—×œ×”"),end_time:B().min(1,"× ×“×¨×©×ª ×©×¢×ª ×¡×™×•×"),required_employees:Ke().min(1,"× ×“×¨×© ×œ×¤×—×•×ª ×¢×•×‘×“ ××—×“"),requires_weapon:he().optional(),requires_vehicle:he().optional(),notes:B().optional()});function Ot({shiftId:n,onClose:a}){const t=se(),[r,s]=O.useState("×××‘×˜×—"),[i,l]=O.useState(""),[h,x]=O.useState(!1),{data:f,isLoading:g}=Y({queryKey:["shift-detail",n],queryFn:()=>K.getOne(n).then(d=>d.data)}),c=(f==null?void 0:f.shift)??f,u=(f==null?void 0:f.assignments)??(c==null?void 0:c.assignments)??[],{data:o}=Y({queryKey:["employees-active"],queryFn:()=>We.getAll({status:"active",limit:200}).then(d=>d.data)}),v=(o==null?void 0:o.employees)??[],k=$({mutationFn:d=>K.assign(n,d),onSuccess:()=>{t.invalidateQueries({queryKey:["shift-detail",n]}),t.invalidateQueries({queryKey:["shifts"]}),p.success("×”×¢×•×‘×“ ×©×•×‘×¥ ×‘×”×¦×œ×—×”"),l(""),s("×××‘×˜×—")},onError:()=>{p.error("×©×’×™××” ×‘×©×™×‘×•×¥ ×”×¢×•×‘×“")}}),C=$({mutationFn:d=>K.unassign(n,d),onSuccess:()=>{t.invalidateQueries({queryKey:["shift-detail",n]}),t.invalidateQueries({queryKey:["shifts"]}),p.success("×”×¢×•×‘×“ ×”×•×¡×¨ ××”××©××¨×ª")},onError:()=>{p.error("×©×’×™××” ×‘×”×¡×¨×ª ×”×¢×•×‘×“")}}),D=$({mutationFn:()=>K.delete(n),onSuccess:()=>{t.invalidateQueries({queryKey:["shifts"]}),p.success("×”××©××¨×ª × ××—×§×” ×‘×”×¦×œ×—×”"),a()},onError:()=>{p.error("×©×’×™××” ×‘××—×™×§×ª ×”××©××¨×ª")}}),M=$({mutationFn:({phone:d,name:b})=>{const V=`×©×œ×•× ${b}, ×ª×–×›×•×¨×ª ×œ××©××¨×ª:
ğŸ“ ${c==null?void 0:c.company_name} - ${c==null?void 0:c.site_name}
ğŸ“… ${c==null?void 0:c.date}
â° ${c==null?void 0:c.start_time} - ${c==null?void 0:c.end_time}${c!=null&&c.site_address?`
ğŸ—ºï¸ ${c.site_address}`:""}`;return $e.sendWhatsApp(Tt(d),V)},onSuccess:()=>{p.success("×ª×–×›×•×¨×ª × ×©×œ×—×” ×‘×”×¦×œ×—×”")},onError:()=>{p.error("×©×’×™××” ×‘×©×œ×™×—×ª ×ª×–×›×•×¨×ª")}}),T=$({mutationFn:d=>K.checkIn(d),onSuccess:()=>{t.invalidateQueries({queryKey:["shift-detail",n]}),t.invalidateQueries({queryKey:["shifts"]}),p.success("×¦'×§-××™×Ÿ ×‘×•×¦×¢ ×‘×”×¦×œ×—×”")},onError:()=>p.error("×©×’×™××” ×‘×‘×™×¦×•×¢ ×¦'×§-××™×Ÿ")}),E=$({mutationFn:d=>K.checkOut(d),onSuccess:()=>{t.invalidateQueries({queryKey:["shift-detail",n]}),t.invalidateQueries({queryKey:["shifts"]}),p.success("×¦'×§-×××•×˜ ×‘×•×¦×¢ ×‘×”×¦×œ×—×”")},onError:()=>p.error("×©×’×™××” ×‘×‘×™×¦×•×¢ ×¦'×§-×××•×˜")}),R=(c==null?void 0:c.date)===S(new Date,"yyyy-MM-dd"),U=()=>{const d=u.filter(b=>b.employee_phone);if(d.length===0){p.error("××™×Ÿ ××¡×¤×¨×™ ×˜×œ×¤×•×Ÿ ×œ×¢×•×‘×“×™× ×”××©×•×‘×¦×™×");return}d.forEach(b=>{M.mutate({phone:b.employee_phone,name:b.employee_name})})},j=()=>{if(!i){p.error("× × ×œ×‘×—×•×¨ ×¢×•×‘×“");return}k.mutate({employee_id:i,role:r})},A=()=>{D.mutate()},W=d=>{switch(d){case"checked_in":return e.jsx("span",{className:"badge-success",children:"× ×›× ×¡"});case"checked_out":return e.jsx("span",{className:"badge-info",children:"×™×¦×"});case"no_show":return e.jsx("span",{className:"badge-danger",children:"×œ× ×”×’×™×¢"});default:return e.jsx("span",{className:"badge-warning",children:"××©×•×‘×¥"})}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"×¤×¨×˜×™ ××©××¨×ª"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(re,{className:"w-5 h-5"})})]}),g?e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"})}):c?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-lg",children:c.company_name}),e.jsxs("p",{className:"text-gray-500",children:[c.site_name,c.site_address?` - ${c.site_address}`:""]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700",children:c.date?S(new Date(c.date+"T00:00:00"),"EEEE, d MMMM yyyy",{locale:ee}):""}),e.jsxs("p",{className:"text-gray-500",children:[c.start_time," - ",c.end_time]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-gray-400"}),e.jsxs("span",{children:["× ×“×¨×©×™×: ",c.required_employees," ×¢×•×‘×“×™×"]})]}),c.requires_weapon&&e.jsxs("div",{className:"flex items-center gap-1 text-orange-600",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"× ×“×¨×© × ×©×§"})]}),c.requires_vehicle&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"× ×“×¨×© ×¨×›×‘"})]})]}),c.notes&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-600",children:c.notes})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5"}),"×¢×•×‘×“×™× ××©×•×‘×¦×™× (",u.length,"/",c.required_employees,")"]}),u.length>0&&e.jsxs("button",{onClick:U,disabled:M.isPending,className:"text-sm flex items-center gap-1 px-3 py-1.5 rounded-lg bg-green-50 text-green-700 hover:bg-green-100 transition-colors",children:[e.jsx(Ge,{className:"w-3.5 h-3.5"}),"×©×œ×— ×ª×–×›×•×¨×ª ×œ×›×•×œ×"]})]}),u.length>0?e.jsx("div",{className:"space-y-2",children:u.map(d=>{var b;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 text-primary-700 rounded-full flex items-center justify-center text-sm font-medium",children:((b=d.employee_name)==null?void 0:b.charAt(0))||"?"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:d.employee_name}),e.jsx("p",{className:"text-sm text-gray-500",children:d.role})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[W(d.status),R&&d.status==="assigned"&&e.jsxs("button",{onClick:()=>T.mutate(d.id),disabled:T.isPending,className:"flex items-center gap-1 px-2 py-1 text-xs rounded-lg bg-green-100 text-green-700 hover:bg-green-200 transition-colors",title:"×¦'×§-××™×Ÿ",children:[e.jsx(Be,{className:"w-3.5 h-3.5"}),"×›× ×™×¡×”"]}),R&&d.status==="checked_in"&&!d.check_out_time&&e.jsxs("button",{onClick:()=>E.mutate(d.id),disabled:E.isPending,className:"flex items-center gap-1 px-2 py-1 text-xs rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors",title:"×¦'×§-×××•×˜",children:[e.jsx(Ye,{className:"w-3.5 h-3.5"}),"×™×¦×™××”"]}),d.check_in_time&&e.jsx("span",{className:"text-xs text-gray-400",title:"×©×¢×ª ×›× ×™×¡×”",children:new Date(d.check_in_time).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})}),d.check_out_time&&e.jsxs("span",{className:"text-xs text-gray-400",title:"×©×¢×ª ×™×¦×™××”",children:["- ",new Date(d.check_out_time).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"})]}),d.employee_phone&&e.jsx("button",{onClick:()=>M.mutate({phone:d.employee_phone,name:d.employee_name}),disabled:M.isPending,className:"text-green-500 hover:text-green-700 hover:bg-green-50 p-1.5 rounded-lg transition-colors",title:"×©×œ×— ×ª×–×›×•×¨×ª WhatsApp",children:e.jsx(Ie,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C.mutate(d.id),disabled:C.isPending,className:"text-red-500 hover:text-red-700 hover:bg-red-50 p-1.5 rounded-lg transition-colors text-sm",title:"×”×¡×¨ ××”××©××¨×ª",children:"×”×¡×¨"})]})]},d.id)})}):e.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"××™×Ÿ ×¢×•×‘×“×™× ××©×•×‘×¦×™× ×œ××©××¨×ª ×–×•"})]}),c.site_id&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"×¡×™×•×¨×™× ×•× ×§×•×“×•×ª ×‘×™×§×•×¨×ª"]}),e.jsx(Ct,{siteId:c.site_id})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),"×©×‘×¥ ×¢×•×‘×“"]}),e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"label",children:"×¢×•×‘×“"}),e.jsxs("select",{value:i,onChange:d=>l(d.target.value),className:"input",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×¢×•×‘×“..."}),v.map(d=>e.jsxs("option",{value:d.id,children:[d.first_name," ",d.last_name]},d.id))]})]}),e.jsxs("div",{className:"w-40",children:[e.jsx("label",{className:"label",children:"×ª×¤×§×™×“"}),e.jsx("input",{type:"text",value:r,onChange:d=>s(d.target.value),className:"input",placeholder:"×××‘×˜×—"})]}),e.jsx("button",{onClick:j,disabled:k.isPending||!i,className:"btn-primary whitespace-nowrap",children:k.isPending?"××©×‘×¥...":"×©×‘×¥"})]})]}),e.jsx("div",{className:"border-t pt-4",children:h?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(_e,{className:"w-5 h-5 text-red-600"}),e.jsx("p",{className:"font-medium text-red-800",children:"×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××©××¨×ª ×–×•?"})]}),e.jsx("p",{className:"text-sm text-red-600 mb-3",children:"×¤×¢×•×œ×” ×–×• ×ª××—×§ ××ª ×”××©××¨×ª ×•××ª ×›×œ ×”×©×™×‘×•×¦×™× ×©×œ×”. ×œ× × ×™×ª×Ÿ ×œ×‘×˜×œ ×¤×¢×•×œ×” ×–×•."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:A,disabled:D.isPending,className:"btn-danger",children:D.isPending?"××•×—×§...":"×›×Ÿ, ××—×§"}),e.jsx("button",{onClick:()=>x(!1),className:"btn-secondary",children:"×‘×™×˜×•×œ"})]})]}):e.jsxs("button",{onClick:()=>x(!0),className:"btn-danger flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"××—×§ ××©××¨×ª"]})})]}):e.jsx("div",{className:"flex items-center justify-center h-48 text-gray-400",children:"×œ× × ××¦××• ×¤×¨×˜×™ ××©××¨×ª"})]})})}function At(){var w,P,H,ue;const[n,a]=O.useState(new Date),[t,r]=O.useState(!1),[s,i]=O.useState(null),[l,h]=O.useState(""),[x,f]=O.useState(!1),[g,c]=O.useState(!1),[u,o]=O.useState(null),v=ze(n,{weekStartsOn:0}),k=se(),{data:C,isLoading:D}=Y({queryKey:["shifts",S(v,"yyyy-MM-dd")],queryFn:()=>K.getAll({start_date:S(v,"yyyy-MM-dd"),end_date:S(z(v,6),"yyyy-MM-dd")}).then(m=>m.data)}),{data:M}=Y({queryKey:["customers-list"],queryFn:()=>je.getAll({limit:100,status:"active"}).then(m=>m.data)}),{data:T}=Y({queryKey:["sites",l],queryFn:()=>l?we.getByCustomer(l).then(m=>m.data):Promise.resolve({sites:[]}),enabled:!!l}),{data:E}=Y({queryKey:["shift-templates"],queryFn:()=>J.getAll().then(m=>m.data),enabled:x}),R=$({mutationFn:m=>J.delete(m),onSuccess:()=>{k.invalidateQueries({queryKey:["shift-templates"]}),p.success("×”×ª×‘× ×™×ª × ××—×§×”")},onError:()=>p.error("×©×’×™××” ×‘××—×™×§×”")}),U=$({mutationFn:m=>K.create(m),onSuccess:()=>{k.invalidateQueries({queryKey:["shifts"]}),p.success("××©××¨×ª × ×•×¦×¨×” ×‘×”×¦×œ×—×”"),r(!1),W(),h("")},onError:()=>{p.error("×©×’×™××” ×‘×™×¦×™×¨×ª ××©××¨×ª")}}),{register:j,handleSubmit:A,reset:W,setValue:d,formState:{errors:b}}=Fe({resolver:Le(St),defaultValues:{date:S(new Date,"yyyy-MM-dd"),required_employees:1,requires_weapon:!1,requires_vehicle:!1}}),V=m=>{U.mutate({...m,customer_id:l||void 0})},ne=Array.from({length:7},(m,L)=>z(v,L)),ie=m=>{var G;const L=S(m,"yyyy-MM-dd");return((G=C==null?void 0:C.shifts)==null?void 0:G.filter(N=>N.date===L))||[]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"××©××¨×•×ª"}),e.jsx("p",{className:"text-gray-500",children:"×œ×•×— ××©××¨×•×ª ×©×‘×•×¢×™"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>f(!x),className:"btn-secondary flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5"}),"×ª×‘× ×™×•×ª"]}),e.jsxs("button",{onClick:()=>r(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"××©××¨×ª ×—×“×©×”"]})]})]}),x&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"×ª×‘× ×™×•×ª ××©××¨×•×ª"}),e.jsxs("button",{onClick:()=>c(!0),className:"btn-primary text-sm flex items-center gap-1",children:[e.jsx(xe,{className:"w-4 h-4"}),"×ª×‘× ×™×ª ×—×“×©×”"]})]}),((w=E==null?void 0:E.templates)==null?void 0:w.length)>0?e.jsx("div",{className:"space-y-2",children:E.templates.map(m=>{const L=typeof m.days_of_week=="string"?JSON.parse(m.days_of_week):m.days_of_week,G=["×","×‘","×’","×“","×”","×•","×©"];return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${m.is_active?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[m.company_name&&`${m.company_name} `,m.site_name&&`- ${m.site_name} `,"| ",m.start_time,"-",m.end_time,"| ",m.required_employees," ×¢×•×‘×“×™×"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["×™××™×: ",(L||[]).map(N=>G[N]).join(", ")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>o({id:m.id,name:m.name}),className:"btn-success text-xs flex items-center gap-1 px-2 py-1",children:[e.jsx(Te,{className:"w-3.5 h-3.5"}),"×¦×•×¨ ××©××¨×•×ª"]}),e.jsx("button",{onClick:()=>R.mutate(m.id),className:"text-red-400 hover:text-red-600 p-1",children:e.jsx(Ce,{className:"w-4 h-4"})})]})]},m.id)})}):e.jsx("p",{className:"text-gray-400 text-center py-4",children:"××™×Ÿ ×ª×‘× ×™×•×ª. ×¦×•×¨ ×ª×‘× ×™×ª ×¨××©×•× ×” ×›×“×™ ×œ×—×¡×•×š ×–××Ÿ."})]}),g&&e.jsx(_t,{onClose:()=>c(!1)}),u&&e.jsx(kt,{templateId:u.id,templateName:u.name,onClose:()=>o(null)}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>a(z(n,-7)),className:"btn-secondary p-2",children:e.jsx(Ae,{className:"w-5 h-5"})}),e.jsxs("h2",{className:"text-lg font-semibold",children:[S(v,"d MMMM",{locale:ee})," -"," ",S(z(v,6),"d MMMM yyyy",{locale:ee})]}),e.jsx("button",{onClick:()=>a(z(n,7)),className:"btn-secondary p-2",children:e.jsx(He,{className:"w-5 h-5"})})]})}),D?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-primary-500 border-t-transparent"})}):e.jsx("div",{className:"grid grid-cols-7 gap-4",children:ne.map(m=>{const L=ie(m),G=S(m,"yyyy-MM-dd")===S(new Date,"yyyy-MM-dd");return e.jsxs("div",{className:`card p-3 min-h-[200px] ${G?"ring-2 ring-primary-500":""}`,children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("p",{className:"text-sm text-gray-500",children:S(m,"EEEE",{locale:ee})}),e.jsx("p",{className:`text-lg font-bold ${G?"text-primary-600":""}`,children:S(m,"d")})]}),e.jsx("div",{className:"space-y-2",children:L.length>0?L.map(N=>e.jsxs("div",{onClick:()=>i(N.id),className:`p-2 rounded text-xs cursor-pointer hover:shadow-md transition-shadow ${N.assigned_count>=N.required_employees?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsx("p",{className:"font-medium truncate",children:N.company_name}),e.jsx("p",{className:"text-gray-500 truncate",children:N.site_name}),e.jsxs("p",{className:"text-gray-500",children:[N.start_time," - ",N.end_time]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3"}),e.jsxs("span",{children:[N.assigned_count,"/",N.required_employees]})]}),N.requires_weapon&&e.jsx(oe,{className:"w-3 h-3 text-orange-500"}),N.requires_vehicle&&e.jsx(ce,{className:"w-3 h-3 text-blue-500"})]})]},N.id)):e.jsx("p",{className:"text-xs text-gray-400 text-center",children:"××™×Ÿ ××©××¨×•×ª"})})]},m.toISOString())})}),s&&e.jsx(Ot,{shiftId:s,onClose:()=>i(null)}),t&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"××©××¨×ª ×—×“×©×”"}),e.jsx("button",{onClick:()=>{r(!1),W(),h("")},className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:A(V),className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×œ×§×•×— *"}),e.jsxs("select",{value:l,onChange:m=>{h(m.target.value),d("site_id","")},className:"input",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×œ×§×•×—..."}),(P=M==null?void 0:M.customers)==null?void 0:P.map(m=>e.jsx("option",{value:m.id,children:m.company_name},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"××ª×¨"}),e.jsxs("select",{...j("site_id"),className:"input",disabled:!l,children:[e.jsx("option",{value:"",children:l?((H=T==null?void 0:T.sites)==null?void 0:H.length)===0?"××™×Ÿ ××ª×¨×™× ×œ×œ×§×•×— ×–×”":"×‘×—×¨ ××ª×¨...":"×™×© ×œ×‘×—×•×¨ ×œ×§×•×— ×ª×—×™×œ×”..."}),(ue=T==null?void 0:T.sites)==null?void 0:ue.map(m=>e.jsxs("option",{value:m.id,children:[m.name," - ",m.address]},m.id))]}),!l&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"×‘×—×¨ ×œ×§×•×— ×›×“×™ ×œ×¨××•×ª ××ª ×¨×©×™××ª ×”××ª×¨×™×"}),b.site_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.site_id.message})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×ª××¨×™×š *"}),e.jsx("input",{...j("date"),type:"date",className:"input"}),b.date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.date.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×©×¢×ª ×”×ª×—×œ×” *"}),e.jsx("input",{...j("start_time"),type:"time",className:"input"}),b.start_time&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.start_time.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{...j("end_time"),type:"time",className:"input"}),b.end_time&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.end_time.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"××¡×¤×¨ ×¢×•×‘×“×™× × ×“×¨×© *"}),e.jsx("input",{...j("required_employees",{valueAsNumber:!0}),type:"number",min:"1",className:"input w-32"}),b.required_employees&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.required_employees.message})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"×“×¨×™×©×•×ª"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{...j("requires_weapon"),type:"checkbox",className:"w-4 h-4 text-primary-600 rounded"}),e.jsx(oe,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{children:"× ×“×¨×© × ×©×§"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{...j("requires_vehicle"),type:"checkbox",className:"w-4 h-4 text-primary-600 rounded"}),e.jsx(ce,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"× ×“×¨×© ×¨×›×‘"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{...j("notes"),className:"input min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:U.isPending,className:"btn-primary flex-1",children:U.isPending?"×©×•××¨...":"×©××•×¨"}),e.jsx("button",{type:"button",onClick:()=>{r(!1),W(),h("")},className:"btn-secondary",children:"×‘×™×˜×•×œ"})]})]})]})})]})}export{At as default};
